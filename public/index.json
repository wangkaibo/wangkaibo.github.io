[{"content":"","date":null,"permalink":"/","section":"Congo","summary":"","title":"Congo"},{"content":"","date":null,"permalink":"/post/","section":"Posts","summary":"","title":"Posts"},{"content":"","date":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯ #å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ p1ï¼Œp2ï¼Œä»headèŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ¯æ¬¡å¾ªç¯p1å‘å‰ç§»ä¸€ä½ï¼Œp2å‘å‰ç§»ä¸¤ä½ï¼Œè‹¥é“¾è¡¨å­˜åœ¨ç¯åˆ™p1ï¼Œp2å¿…ç„¶æœ‰ç›¸ç­‰çš„æ—¶å€™ã€‚\nfunction hasCycle($linkedList) { $p1 = $p2 = $linkedList-\u0026gt;headNode; while ($p1-\u0026gt;nextNode) { $p1 = $p1-\u0026gt;nextNode; $p2 = $p2-\u0026gt;nextNode-\u0026gt;nextNode; if ($p1 == $p2) { return true; } } return false; } æ‰¾å‡ºç¯çš„ä½ç½® # å‡è®¾ p1 ç»è¿‡çš„è·¯ç¨‹æ˜¯ Sï¼Œå› ä¸º p2 é€Ÿåº¦æ˜¯ p1 çš„ 2 å€ï¼Œæ‰€ä»¥ p2 ç»è¿‡çš„è·¯ç¨‹ä¸º2S\nå‡è®¾ p2 æ¯” p1 å¤šèµ°nåœˆçš„è·ç¦»æ‰åˆ°è¾¾æ±‡åˆç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥å¾—å‡ºï¼š\n$2S = S + NR$ å³$S=NR$\nä»£å…¥ $2S = A+ X + NR$\nå¾—å‡º $NR = A + X$\nåˆ $R=X+T$\nä»£å…¥å¾—\n$NR=A+R-T$$ å³ $$A=(N-1)R+T$\næ ¹æ®ä¸Šè¿°æ¨å¯¼çš„å…¬å¼å¯ä»¥å¾—å‡ºç»“è®ºï¼šä»æ±‡åˆç‚¹å’Œèµ·ç‚¹çš„ä¸¤ä¸ªæŒ‡é’ˆå®šä¼šåœ¨ç¯çš„äº¤ç‚¹ç›¸é‡ï¼\nä»£ç æ¥äº†\nfunction getCycleNode($linkedList) { $p1 = $p2 = $linkedList-\u0026gt;headNode; while($p1-\u0026gt;nextNode) { $p1 = $p1-\u0026gt;nextNode; $p2 = $p2-\u0026gt;nextNode-\u0026gt;nextNode; if ($p1 == $p2) { break; } } if (!$p1) { return false; } $p3 = $linkedList-\u0026gt;headNode; while($p1 != $p3) { $p1 = $p1-\u0026gt;nextNode; $p3 = $p3-\u0026gt;nextNode; } return p1; } ","date":"21 January 2018","permalink":"/linked-list-cycle/","section":"Posts","summary":"åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯ #å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ p1ï¼Œp2ï¼Œä»headèŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ¯æ¬¡å¾ªç¯p1å‘å‰ç§»ä¸€ä½ï¼Œp2å‘å‰ç§»ä¸¤ä½ï¼Œè‹¥é“¾è¡¨å­˜åœ¨ç¯åˆ™p1ï¼Œp2å¿…ç„¶æœ‰ç›¸ç­‰çš„æ—¶å€™ã€‚","title":"å•å‘é“¾è¡¨ç¯é—®é¢˜"},{"content":"å‹æƒ…é“¾æ¥ #å´é’§æ³½åšå®¢\n","date":"21 January 2018","permalink":"/links/","section":"Congo","summary":"å‹æƒ…é“¾æ¥ #å´é’§æ³½åšå®¢","title":"å‹æƒ…é“¾æ¥"},{"content":"","date":null,"permalink":"/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","section":"Tags","summary":"","title":"æ•°æ®ç»“æ„"},{"content":"","date":null,"permalink":"/tags/%E7%AE%97%E6%B3%95/","section":"Tags","summary":"","title":"ç®—æ³•"},{"content":"ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¸ƒéš†è¿‡æ»¤å™¨ï¼Ÿ #å…ˆæ¥çœ‹å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­\nå­—å¤„ç†è½¯ä»¶ä¸­ï¼Œéœ€è¦æ£€æŸ¥ä¸€ä¸ªè‹±è¯­å•è¯æ˜¯å¦æ‹¼å†™æ­£ç¡® åœ¨ FBIï¼Œä¸€ä¸ªå«Œç–‘äººçš„åå­—æ˜¯å¦å·²ç»åœ¨å«Œç–‘åå•ä¸Š åœ¨ç½‘ç»œçˆ¬è™«é‡Œï¼Œä¸€ä¸ªç½‘å€æ˜¯å¦è¢«è®¿é—®è¿‡ yahoo, gmailç­‰é‚®ç®±åƒåœ¾é‚®ä»¶è¿‡æ»¤åŠŸèƒ½ è¿™å‡ ä¸ªä¾‹å­æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼š å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Ÿ\nå¸¸è§„æ€è·¯ # æ•°ç»„ é“¾è¡¨ æ ‘ã€å¹³è¡¡äºŒå‰æ ‘ã€Trie Map (çº¢é»‘æ ‘) å“ˆå¸Œè¡¨ è™½ç„¶ä¸Šé¢æè¿°çš„è¿™å‡ ç§æ•°æ®ç»“æ„é…åˆå¸¸è§çš„æ’åºã€äºŒåˆ†æœç´¢å¯ä»¥å¿«é€Ÿé«˜æ•ˆçš„å¤„ç†ç»å¤§éƒ¨åˆ†åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨é›†åˆä¸­çš„éœ€æ±‚ã€‚ä½†æ˜¯å½“é›†åˆé‡Œé¢çš„å…ƒç´ æ•°é‡è¶³å¤Ÿå¤§ï¼Œå¦‚æœæœ‰500ä¸‡æ¡è®°å½•ç”šè‡³1äº¿æ¡è®°å½•å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å¸¸è§„çš„æ•°æ®ç»“æ„çš„é—®é¢˜å°±å‡¸æ˜¾å‡ºæ¥äº†ã€‚æ•°ç»„ã€é“¾è¡¨ã€æ ‘ç­‰æ•°æ®ç»“æ„ä¼šå­˜å‚¨å…ƒç´ çš„å†…å®¹ï¼Œä¸€æ—¦æ•°æ®é‡è¿‡å¤§ï¼Œæ¶ˆè€—çš„å†…å­˜ä¹Ÿä¼šå‘ˆç°çº¿æ€§å¢é•¿ï¼Œæœ€ç»ˆè¾¾åˆ°ç“¶é¢ˆã€‚æœ‰çš„åŒå­¦å¯èƒ½ä¼šé—®ï¼Œå“ˆå¸Œè¡¨ä¸æ˜¯æ•ˆç‡å¾ˆé«˜å—ï¼ŸæŸ¥è¯¢æ•ˆç‡å¯ä»¥è¾¾åˆ°O(1)ã€‚ä½†æ˜¯å“ˆå¸Œè¡¨éœ€è¦æ¶ˆè€—çš„å†…å­˜ä¾ç„¶å¾ˆé«˜ã€‚ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨ä¸€äº¿ ä¸ªåƒåœ¾ email åœ°å€çš„æ¶ˆè€—ï¼Ÿå“ˆå¸Œè¡¨çš„åšæ³•ï¼šé¦–å…ˆï¼Œå“ˆå¸Œå‡½æ•°å°†ä¸€ä¸ªemailåœ°å€æ˜ å°„æˆ8å­—èŠ‚ä¿¡æ¯æŒ‡çº¹ï¼›è€ƒè™‘åˆ°å“ˆå¸Œè¡¨å­˜å‚¨æ•ˆç‡é€šå¸¸å°äº50%ï¼ˆå“ˆå¸Œå†²çªï¼‰ï¼›å› æ­¤æ¶ˆè€—çš„å†…å­˜ï¼š8 * 2 * 1äº¿ å­—èŠ‚ = 1.6G å†…å­˜ï¼Œæ™®é€šè®¡ç®—æœºæ˜¯æ— æ³•æä¾›å¦‚æ­¤å¤§çš„å†…å­˜ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰å°±åº”è¿è€Œç”Ÿã€‚åœ¨ç»§ç»­ä»‹ç»å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†æ—¶ï¼Œå…ˆè®²è§£ä¸‹å…³äºå“ˆå¸Œå‡½æ•°çš„é¢„å¤‡çŸ¥è¯†ã€‚\nå“ˆå¸Œå‡½æ•° #å“ˆå¸Œå‡½æ•°çš„æ¦‚å¿µæ˜¯ï¼šå°†ä»»æ„å¤§å°çš„æ•°æ®è½¬æ¢æˆç‰¹å®šå¤§å°çš„æ•°æ®çš„å‡½æ•°ï¼Œè½¬æ¢åçš„æ•°æ®ç§°ä¸ºå“ˆå¸Œå€¼æˆ–å“ˆå¸Œç¼–ç ã€‚ä¸‹é¢æ˜¯ä¸€å¹…ç¤ºæ„å›¾ï¼š\nå¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ï¼ŒåŸå§‹æ•°æ®ç»è¿‡å“ˆå¸Œå‡½æ•°çš„æ˜ å°„åç§°ä¸ºäº†ä¸€ä¸ªä¸ªçš„å“ˆå¸Œç¼–ç ï¼Œæ•°æ®å¾—åˆ°å‹ç¼©ã€‚å“ˆå¸Œå‡½æ•°æ˜¯å®ç°å“ˆå¸Œè¡¨å’Œå¸ƒéš†è¿‡æ»¤å™¨çš„åŸºç¡€ã€‚\nå¸ƒéš†è¿‡æ»¤å™¨ä»‹ç» # å·´é¡¿.å¸ƒéš†äºä¸€ä¹ä¸ƒé›¶å¹´æå‡º ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ ï¼ˆä½æ•°ç»„ï¼‰ ä¸€ç³»åˆ—éšæœºå‡½æ•° (å“ˆå¸Œ) ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ•ˆç‡é«˜ æœ‰ä¸€å®šçš„è¯¯åˆ¤ç‡ï¼ˆå“ˆå¸Œè¡¨æ˜¯ç²¾ç¡®åŒ¹é…ï¼‰ å¸ƒéš†è¿‡æ»¤å™¨åŸç† #å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰çš„æ ¸å¿ƒå®ç°æ˜¯ä¸€ä¸ªè¶…å¤§çš„ä½æ•°ç»„å’Œå‡ ä¸ªå“ˆå¸Œå‡½æ•°ã€‚å‡è®¾ä½æ•°ç»„çš„é•¿åº¦ä¸ºmï¼Œå“ˆå¸Œå‡½æ•°çš„ä¸ªæ•°ä¸ºk\nä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå…·ä½“çš„æ“ä½œæµç¨‹ï¼šå‡è®¾é›†åˆé‡Œé¢æœ‰3ä¸ªå…ƒç´ {x, y, z}ï¼Œå“ˆå¸Œå‡½æ•°çš„ä¸ªæ•°ä¸º3ã€‚é¦–å…ˆå°†ä½æ•°ç»„è¿›è¡Œåˆå§‹åŒ–ï¼Œå°†é‡Œé¢æ¯ä¸ªä½éƒ½è®¾ç½®ä½0ã€‚å¯¹äºé›†åˆé‡Œé¢çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…ƒç´ ä¾æ¬¡é€šè¿‡3ä¸ªå“ˆå¸Œå‡½æ•°è¿›è¡Œæ˜ å°„ï¼Œæ¯æ¬¡æ˜ å°„éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œè¿™ä¸ªå€¼å¯¹åº”ä½æ•°ç»„ä¸Šé¢çš„ä¸€ä¸ªç‚¹ï¼Œç„¶åå°†ä½æ•°ç»„å¯¹åº”çš„ä½ç½®æ ‡è®°ä¸º1ã€‚æŸ¥è¯¢Wå…ƒç´ æ˜¯å¦å­˜åœ¨é›†åˆä¸­çš„æ—¶å€™ï¼ŒåŒæ ·çš„æ–¹æ³•å°†Wé€šè¿‡å“ˆå¸Œæ˜ å°„åˆ°ä½æ•°ç»„ä¸Šçš„3ä¸ªç‚¹ã€‚å¦‚æœ3ä¸ªç‚¹çš„å…¶ä¸­æœ‰ä¸€ä¸ªç‚¹ä¸ä¸º1ï¼Œåˆ™å¯ä»¥åˆ¤æ–­è¯¥å…ƒç´ ä¸€å®šä¸å­˜åœ¨é›†åˆä¸­ã€‚åä¹‹ï¼Œå¦‚æœ3ä¸ªç‚¹éƒ½ä¸º1ï¼Œåˆ™è¯¥å…ƒç´ å¯èƒ½å­˜åœ¨é›†åˆä¸­ã€‚æ³¨æ„ï¼šæ­¤å¤„ä¸èƒ½åˆ¤æ–­è¯¥å…ƒç´ æ˜¯å¦ä¸€å®šå­˜åœ¨é›†åˆä¸­ï¼Œå¯èƒ½å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤ç‡ã€‚å¯ä»¥ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼šå‡è®¾æŸä¸ªå…ƒç´ é€šè¿‡æ˜ å°„å¯¹åº”ä¸‹æ ‡ä¸º4ï¼Œ5ï¼Œ6è¿™3ä¸ªç‚¹ã€‚è™½ç„¶è¿™3ä¸ªç‚¹éƒ½ä¸º1ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾è¿™3ä¸ªç‚¹æ˜¯ä¸åŒå…ƒç´ ç»è¿‡å“ˆå¸Œå¾—åˆ°çš„ä½ç½®ï¼Œå› æ­¤è¿™ç§æƒ…å†µè¯´æ˜å…ƒç´ è™½ç„¶ä¸åœ¨é›†åˆä¸­ï¼Œä¹Ÿå¯èƒ½å¯¹åº”çš„éƒ½æ˜¯1ï¼Œè¿™æ˜¯è¯¯åˆ¤ç‡å­˜åœ¨çš„åŸå› ã€‚\nå¸ƒéš†è¿‡æ»¤å™¨æ·»åŠ å…ƒç´  # å°†è¦æ·»åŠ çš„å…ƒç´ ç»™kä¸ªå“ˆå¸Œå‡½æ•° å¾—åˆ°å¯¹åº”äºä½æ•°ç»„ä¸Šçš„kä¸ªä½ç½® å°†è¿™kä¸ªä½ç½®è®¾ä¸º1 å¸ƒéš†è¿‡æ»¤å™¨æŸ¥è¯¢å…ƒç´  # å°†è¦æŸ¥è¯¢çš„å…ƒç´ ç»™kä¸ªå“ˆå¸Œå‡½æ•° å¾—åˆ°å¯¹åº”äºä½æ•°ç»„ä¸Šçš„kä¸ªä½ç½® å¦‚æœkä¸ªä½ç½®æœ‰ä¸€ä¸ªä¸º0ï¼Œåˆ™è‚¯å®šä¸åœ¨é›†åˆä¸­ å¦‚æœkä¸ªä½ç½®å…¨éƒ¨ä¸º1ï¼Œåˆ™å¯èƒ½åœ¨é›†åˆä¸­ å¸ƒéš†è¿‡æ»¤å™¨å®ç° #ä¸‹é¢ç»™å‡ºpythonçš„å®ç°ï¼Œä½¿ç”¨murmurhashç®—æ³•\nimport mmh3 from bitarray import bitarray # zhihu_crawler.bloom_filter # Implement a simple bloom filter with murmurhash algorithm. # Bloom filter is used to check wether an element exists in a collection, and it has a good performance in big data situation. # It may has positive rate depend on hash functions and elements count. BIT_SIZE = 5000000 class BloomFilter: def __init__(self): # Initialize bloom filter, set size and all bits to 0 bit_array = bitarray(BIT_SIZE) bit_array.setall(0) self.bit_array = bit_array def add(self, url): # Add a url, and set points in bitarray to 1 (Points count is equal to hash funcs count.) # Here use 7 hash functions. point_list = self.get_postions(url) for b in point_list: self.bit_array[b] = 1 def contains(self, url): # Check if a url is in a collection point_list = self.get_postions(url) result = True for b in point_list: result = result and self.bit_array[b] return result def get_postions(self, url): # Get points positions in bit vector. point1 = mmh3.hash(url, 41) % BIT_SIZE point2 = mmh3.hash(url, 42) % BIT_SIZE point3 = mmh3.hash(url, 43) % BIT_SIZE point4 = mmh3.hash(url, 44) % BIT_SIZE point5 = mmh3.hash(url, 45) % BIT_SIZE point6 = mmh3.hash(url, 46) % BIT_SIZE point7 = mmh3.hash(url, 47) % BIT_SIZE return [point1, point2, point3, point4, point5, point6, point7] åŸæ–‡åœ°å€ï¼šå¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†å’Œå®ç°\nç›¸å…³æ–‡ç« ï¼šåŸºäºRedisçš„å¸ƒéš†è¿‡æ»¤å™¨çš„å®ç°\n","date":"22 December 2017","permalink":"/bu-long-guo-lv-qi-yuan-li-shi-xian/","section":"Posts","summary":"\u003ch3 id=\"ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¸ƒéš†è¿‡æ»¤å™¨\" class=\"relative group\"\u003eä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¸ƒéš†è¿‡æ»¤å™¨ï¼Ÿ \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%e4%bb%80%e4%b9%88%e6%83%85%e5%86%b5%e4%b8%8b%e9%9c%80%e8%a6%81%e5%b8%83%e9%9a%86%e8%bf%87%e6%bb%a4%e5%99%a8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h3\u003e\u003cp\u003eå…ˆæ¥çœ‹å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå­—å¤„ç†è½¯ä»¶ä¸­ï¼Œéœ€è¦æ£€æŸ¥ä¸€ä¸ªè‹±è¯­å•è¯æ˜¯å¦æ‹¼å†™æ­£ç¡®\u003c/li\u003e\n\u003cli\u003eåœ¨ FBIï¼Œä¸€ä¸ªå«Œç–‘äººçš„åå­—æ˜¯å¦å·²ç»åœ¨å«Œç–‘åå•ä¸Š\u003c/li\u003e\n\u003cli\u003eåœ¨ç½‘ç»œçˆ¬è™«é‡Œï¼Œä¸€ä¸ªç½‘å€æ˜¯å¦è¢«è®¿é—®è¿‡\u003c/li\u003e\n\u003cli\u003eyahoo, gmailç­‰é‚®ç®±åƒåœ¾é‚®ä»¶è¿‡æ»¤åŠŸèƒ½\u003c/li\u003e\n\u003c/ul\u003e","title":"ã€è½¬è½½ã€‘å¸ƒéš†è¿‡æ»¤å™¨çš„åŸç†å’Œå®ç°"},{"content":"æ–¹æ³•ä»‹ç» #å¯¹äºæµ·é‡æ•°æ®è€Œè¨€ï¼Œç”±äºæ— æ³•ä¸€æ¬¡æ€§è£…è¿›å†…å­˜å¤„ç†ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸å¾—ä¸æŠŠæµ·é‡çš„æ•°æ®é€šè¿‡hashæ˜ å°„åˆ†å‰²æˆç›¸åº”çš„å°å—æ•°æ®ï¼Œç„¶åå†é’ˆå¯¹å„ä¸ªå°å—æ•°æ®é€šè¿‡hash_mapè¿›è¡Œç»Ÿè®¡æˆ–å…¶å®ƒæ“ä½œã€‚\né‚£ä»€ä¹ˆæ˜¯hashæ˜ å°„å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸ºäº†ä¾¿äºè®¡ç®—æœºåœ¨æœ‰é™çš„å†…å­˜ä¸­å¤„ç†bigæ•°æ®ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ç§æ˜ å°„æ•£åˆ—çš„æ–¹å¼è®©æ•°æ®å‡åŒ€åˆ†å¸ƒåœ¨å¯¹åº”çš„å†…å­˜ä½ç½®(å¦‚å¤§æ•°æ®é€šè¿‡å–ä½™çš„æ–¹å¼æ˜ å°„æˆå°æ•°å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæˆ–å¤§æ–‡ä»¶æ˜ å°„æˆå¤šä¸ªå°æ–‡ä»¶)ï¼Œè€Œè¿™ä¸ªæ˜ å°„æ•£åˆ—æ–¹å¼ä¾¿æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„hashå‡½æ•°ï¼Œè®¾è®¡çš„å¥½çš„hashå‡½æ•°èƒ½è®©æ•°æ®å‡åŒ€åˆ†å¸ƒè€Œå‡å°‘å†²çªã€‚\né—®é¢˜å®ä¾‹ #1ã€æµ·é‡æ—¥å¿—æ•°æ®ï¼Œæå–å‡ºæŸæ—¥è®¿é—®ç™¾åº¦æ¬¡æ•°æœ€å¤šçš„é‚£ä¸ªIP\nåˆ†æï¼šç™¾åº¦ä½œä¸ºå›½å†…ç¬¬ä¸€å¤§æœç´¢å¼•æ“ï¼Œæ¯å¤©è®¿é—®å®ƒçš„IPæ•°é‡å·¨å¤§ï¼Œå¦‚æœæƒ³ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰IPæ•°æ®è£…è¿›å†…å­˜å¤„ç†ï¼Œåˆ™å†…å­˜å®¹é‡æ˜æ˜¾ä¸å¤Ÿï¼Œæ•…é’ˆå¯¹æ•°æ®å¤ªå¤§ï¼Œå†…å­˜å—é™çš„æƒ…å†µï¼Œå¯ä»¥æŠŠå¤§æ–‡ä»¶è½¬åŒ–æˆï¼ˆå–æ¨¡æ˜ å°„ï¼‰å°æ–‡ä»¶ï¼Œä»è€Œå¤§è€ŒåŒ–å°ï¼Œé€ä¸ªå¤„ç†ã€‚\næ¢è¨€ä¹‹ï¼Œå…ˆæ˜ å°„ï¼Œè€Œåç»Ÿè®¡ï¼Œæœ€åæ’åºã€‚\nè§£æ³•ï¼šå…·ä½“åˆ†ä¸ºä»¥ä¸‹3ä¸ªæ­¥éª¤\n1.åˆ†è€Œæ²»ä¹‹/hashæ˜ å°„ é¦–å…ˆæŠŠè¿™ä¸€å¤©è®¿é—®ç™¾åº¦æ—¥å¿—çš„æ‰€æœ‰IPæå–å‡ºæ¥ï¼Œç„¶åé€ä¸ªå†™å…¥åˆ°ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­ï¼Œæ¥ç€é‡‡ç”¨æ˜ å°„çš„æ–¹æ³•ï¼Œæ¯”å¦‚%1000ï¼ŒæŠŠæ•´ä¸ªå¤§æ–‡ä»¶æ˜ å°„ä¸º1000ä¸ªå°æ–‡ä»¶ã€‚ 2.hash_mapç»Ÿè®¡ å½“å¤§æ–‡ä»¶è½¬åŒ–æˆäº†å°æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥é‡‡ç”¨hash_map(ip, value)æ¥åˆ†åˆ«å¯¹1000ä¸ªå°æ–‡ä»¶ä¸­çš„IPè¿›è¡Œé¢‘ç‡ç»Ÿè®¡ï¼Œå†æ‰¾å‡ºæ¯ä¸ªå°æ–‡ä»¶ä¸­å‡ºç°é¢‘ç‡æœ€å¤§çš„IPã€‚ 3.å †/å¿«é€Ÿæ’åº ç»Ÿè®¡å‡º1000ä¸ªé¢‘ç‡æœ€å¤§çš„IPåï¼Œä¾æ®å„è‡ªé¢‘ç‡çš„å¤§å°è¿›è¡Œæ’åº(å¯é‡‡å–å †æ’åº)ï¼Œæ‰¾å‡ºé‚£ä¸ªé¢‘ç‡æœ€å¤§çš„IPï¼Œå³ä¸ºæ‰€æ±‚ã€‚ æ³¨ï¼šHashå–æ¨¡æ˜¯ä¸€ç§ç­‰ä»·æ˜ å°„ï¼Œä¸ä¼šå­˜åœ¨åŒä¸€ä¸ªå…ƒç´ åˆ†æ•£åˆ°ä¸åŒå°æ–‡ä»¶ä¸­å»çš„æƒ…å†µï¼Œå³è¿™é‡Œé‡‡ç”¨çš„æ˜¯%1000ç®—æ³•ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªIPåœ¨hashåï¼Œåªå¯èƒ½è½åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¸å¯èƒ½è¢«åˆ†æ•£çš„ã€‚\n2ã€å¯»æ‰¾çƒ­é—¨æŸ¥è¯¢ï¼Œ300ä¸‡ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ç»Ÿè®¡æœ€çƒ­é—¨çš„10ä¸ªæŸ¥è¯¢\nåŸé¢˜ï¼šæœç´¢å¼•æ“ä¼šé€šè¿‡æ—¥å¿—æ–‡ä»¶æŠŠç”¨æˆ·æ¯æ¬¡æ£€ç´¢ä½¿ç”¨çš„æ‰€æœ‰æ£€ç´¢ä¸²éƒ½è®°å½•ä¸‹æ¥ï¼Œæ¯ä¸ªæŸ¥è¯¢ä¸²çš„é•¿åº¦ä¸º1-255å­—èŠ‚ã€‚å‡è®¾ç›®å‰æœ‰ä¸€åƒä¸‡ä¸ªè®°å½•ï¼Œè¯·ä½ ç»Ÿè®¡æœ€çƒ­é—¨çš„10ä¸ªæŸ¥è¯¢ä¸²ï¼Œè¦æ±‚ä½¿ç”¨çš„å†…å­˜ä¸èƒ½è¶…è¿‡1Gã€‚\nåˆ†æï¼šè¿™äº›æŸ¥è¯¢ä¸²çš„é‡å¤åº¦æ¯”è¾ƒé«˜ï¼Œè™½ç„¶æ€»æ•°æ˜¯1åƒä¸‡ï¼Œä½†å¦‚æœé™¤å»é‡å¤åï¼Œä¸è¶…è¿‡3ç™¾ä¸‡ä¸ªã€‚ä¸€ä¸ªæŸ¥è¯¢ä¸²çš„é‡å¤åº¦è¶Šé«˜ï¼Œè¯´æ˜æŸ¥è¯¢å®ƒçš„ç”¨æˆ·è¶Šå¤šï¼Œä¹Ÿå°±æ˜¯è¶Šçƒ­é—¨ã€‚\nç”±ä¸Šé¢ç¬¬1é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ•°æ®å¤§åˆ™åˆ’ä¸ºå°çš„ï¼Œä¾‹å¦‚ä¸€äº¿ä¸ªipæ±‚Top 10ï¼Œå¯å…ˆ%1000å°†ipåˆ†åˆ°1000ä¸ªå°æ–‡ä»¶ä¸­å»ï¼Œå¹¶ä¿è¯ä¸€ç§ipåªå‡ºç°åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå†å¯¹æ¯ä¸ªå°æ–‡ä»¶ä¸­çš„ipè¿›è¡Œhash_mapç»Ÿè®¡å¹¶æŒ‰æ•°é‡æ’åºï¼Œæœ€åå½’å¹¶æˆ–è€…æœ€å°å †ä¾æ¬¡å¤„ç†æ¯ä¸ªå°æ–‡ä»¶çš„top10ä»¥å¾—åˆ°æœ€åçš„ç»“æœã€‚\nä½†å¯¹äºæœ¬é¢˜ï¼Œæ•°æ®è§„æ¨¡æ¯”è¾ƒå°ï¼Œèƒ½ä¸€æ¬¡æ€§è£…å…¥å†…å­˜ã€‚å› ä¸ºæ ¹æ®é¢˜ç›®æè¿°ï¼Œè™½ç„¶æœ‰ä¸€åƒä¸‡ä¸ªQueryï¼Œä½†æ˜¯ç”±äºé‡å¤åº¦æ¯”è¾ƒé«˜ï¼Œæ•…å»é™¤é‡å¤åï¼Œäº‹å®ä¸Šåªæœ‰300ä¸‡çš„Queryï¼Œæ¯ä¸ªQuery255Byteï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠä»–ä»¬éƒ½æ”¾è¿›å†…å­˜ä¸­å»ï¼ˆ300ä¸‡ä¸ªå­—ç¬¦ä¸²å‡è®¾æ²¡æœ‰é‡å¤ï¼Œéƒ½æ˜¯æœ€å¤§é•¿åº¦ï¼Œé‚£ä¹ˆæœ€å¤šå ç”¨å†…å­˜3M*1K/4=0.75Gã€‚æ‰€ä»¥å¯ä»¥å°†æ‰€æœ‰å­—ç¬¦ä¸²éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­è¿›è¡Œå¤„ç†ï¼‰ã€‚\næ‰€ä»¥æˆ‘ä»¬æ”¾å¼ƒåˆ†è€Œæ²»ä¹‹/hashæ˜ å°„çš„æ­¥éª¤ï¼Œç›´æ¥ä¸Šhash_mapç»Ÿè®¡ï¼Œç„¶åæ’åºã€‚Soï¼Œé’ˆå¯¹æ­¤ç±»å…¸å‹çš„TOP Ké—®é¢˜ï¼Œé‡‡å–çš„å¯¹ç­–å¾€å¾€æ˜¯ï¼šhash_map + å †ã€‚\nè§£æ³•ï¼š\n1.hash_mapç»Ÿè®¡ å…ˆå¯¹è¿™æ‰¹æµ·é‡æ•°æ®é¢„å¤„ç†ã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼šç»´æŠ¤ä¸€ä¸ªKeyä¸ºQueryå­—ä¸²ï¼ŒValueä¸ºè¯¥Queryå‡ºç°æ¬¡æ•°çš„hash_mapï¼Œå³hash_map(Query, Value)ï¼Œæ¯æ¬¡è¯»å–ä¸€ä¸ªQueryï¼Œå¦‚æœè¯¥å­—ä¸²ä¸åœ¨Tableä¸­ï¼Œé‚£ä¹ˆåŠ å…¥è¯¥å­—ä¸²ï¼Œå¹¶å°†Valueå€¼è®¾ä¸º1ï¼›å¦‚æœè¯¥å­—ä¸²åœ¨Tableä¸­ï¼Œé‚£ä¹ˆå°†è¯¥å­—ä¸²çš„è®¡æ•°åŠ 1 å³å¯ã€‚æœ€ç»ˆæˆ‘ä»¬åœ¨O(N)çš„æ—¶é—´å¤æ‚åº¦å†…ç”¨hash_mapå®Œæˆäº†ç»Ÿè®¡ï¼› 2.å †æ’åº å€ŸåŠ©å †è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œæ‰¾å‡ºTop Kï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºNâ€˜logKã€‚å³å€ŸåŠ©å †ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨logé‡çº§çš„æ—¶é—´å†…æŸ¥æ‰¾å’Œè°ƒæ•´/ç§»åŠ¨ã€‚å› æ­¤ï¼Œç»´æŠ¤ä¸€ä¸ªK(è¯¥é¢˜ç›®ä¸­æ˜¯10)å¤§å°çš„å°æ ¹å †ï¼Œç„¶åéå†300ä¸‡çš„Queryï¼Œåˆ†åˆ«å’Œæ ¹å…ƒç´ è¿›è¡Œå¯¹æ¯”ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„æ—¶é—´å¤æ‚åº¦æ˜¯ï¼šO(n) + N\u0026rsquo; * O(logkï¼‰ï¼Œå…¶ä¸­ï¼ŒNä¸º1000ä¸‡ï¼ŒNâ€™ä¸º300ä¸‡ã€‚ å…³äºç¬¬2æ­¥å †æ’åºï¼Œå¯ä»¥ç»´æŠ¤kä¸ªå…ƒç´ çš„æœ€å°å †ï¼Œå³ç”¨å®¹é‡ä¸ºkçš„æœ€å°å †å­˜å‚¨æœ€å…ˆéå†åˆ°çš„kä¸ªæ•°ï¼Œå¹¶å‡è®¾å®ƒä»¬å³æ˜¯æœ€å¤§çš„kä¸ªæ•°ï¼Œå»ºå †è´¹æ—¶Oï¼ˆkï¼‰ï¼Œå¹¶è°ƒæ•´å †(è´¹æ—¶O(logk))åï¼Œæœ‰k1\u0026gt;k2\u0026gt;\u0026hellip;kminï¼ˆkminè®¾ä¸ºå°é¡¶å †ä¸­æœ€å°å…ƒç´ ï¼‰ã€‚ç»§ç»­éå†æ•°åˆ—ï¼Œæ¯æ¬¡éå†ä¸€ä¸ªå…ƒç´ xï¼Œä¸å †é¡¶å…ƒç´ æ¯”è¾ƒï¼Œè‹¥x\u0026gt;kminï¼Œåˆ™æ›´æ–°å †ï¼ˆxå…¥å †ï¼Œç”¨æ—¶logkï¼‰ï¼Œå¦åˆ™ä¸æ›´æ–°å †ã€‚è¿™æ ·ä¸‹æ¥ï¼Œæ€»è´¹æ—¶Oï¼ˆk*logk+ï¼ˆn-kï¼‰logkï¼‰=Oï¼ˆnlogkï¼‰ã€‚æ­¤æ–¹æ³•å¾—ç›Šäºåœ¨å †ä¸­ï¼ŒæŸ¥æ‰¾ç­‰å„é¡¹æ“ä½œæ—¶é—´å¤æ‚åº¦å‡ä¸ºlogkã€‚\nå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨trieæ ‘ï¼Œå…³é”®å­—åŸŸå­˜è¯¥æŸ¥è¯¢ä¸²å‡ºç°çš„æ¬¡æ•°ï¼Œæ²¡æœ‰å‡ºç°ä¸º0ã€‚æœ€åç”¨10ä¸ªå…ƒç´ çš„æœ€å°æ¨æ¥å¯¹å‡ºç°é¢‘ç‡è¿›è¡Œæ’åºã€‚\n3ã€æœ‰ä¸€ä¸ª1Gå¤§å°çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªè¯ï¼Œè¯çš„å¤§å°ä¸è¶…è¿‡16å­—èŠ‚ï¼Œå†…å­˜é™åˆ¶å¤§å°æ˜¯1Mã€‚è¿”å›é¢‘æ•°æœ€é«˜çš„100ä¸ªè¯\nè§£æ³•ï¼š\n1.åˆ†è€Œæ²»ä¹‹/hashæ˜ å°„ é¡ºåºè¯»å–æ–‡ä»¶ï¼Œå¯¹äºæ¯ä¸ªè¯xï¼Œå–hash(x)%5000ï¼Œç„¶åæŠŠè¯¥å€¼å­˜åˆ°5000ä¸ªå°æ–‡ä»¶ï¼ˆè®°ä¸ºx0,x1,\u0026hellip;x4999ï¼‰ä¸­ã€‚è¿™æ ·æ¯ä¸ªæ–‡ä»¶å¤§æ¦‚æ˜¯200kå·¦å³ã€‚å½“ç„¶ï¼Œå¦‚æœå…¶ä¸­æœ‰çš„å°æ–‡ä»¶è¶…è¿‡äº†1Må¤§å°ï¼Œè¿˜å¯ä»¥æŒ‰ç…§ç±»ä¼¼çš„æ–¹æ³•ç»§ç»­å¾€ä¸‹åˆ†ï¼Œç›´åˆ°åˆ†è§£å¾—åˆ°çš„å°æ–‡ä»¶çš„å¤§å°éƒ½ä¸è¶…è¿‡1Mã€‚ 2.hash_mapç»Ÿè®¡ å¯¹æ¯ä¸ªå°æ–‡ä»¶ï¼Œé‡‡ç”¨trieæ ‘/hash_mapç­‰ç»Ÿè®¡æ¯ä¸ªæ–‡ä»¶ä¸­å‡ºç°çš„è¯ä»¥åŠç›¸åº”çš„é¢‘ç‡ã€‚ 3.å †/å½’å¹¶æ’åº å–å‡ºå‡ºç°é¢‘ç‡æœ€å¤§çš„100ä¸ªè¯ï¼ˆå¯ä»¥ç”¨å«100ä¸ªç»“ç‚¹çš„æœ€å°å †ï¼‰åï¼Œå†æŠŠ100ä¸ªè¯åŠç›¸åº”çš„é¢‘ç‡å­˜å…¥æ–‡ä»¶ï¼Œè¿™æ ·åˆå¾—åˆ°äº†5000ä¸ªæ–‡ä»¶ã€‚æœ€åå°±æ˜¯æŠŠè¿™5000ä¸ªæ–‡ä»¶è¿›è¡Œå½’å¹¶ï¼ˆç±»ä¼¼äºå½’å¹¶æ’åºï¼‰çš„è¿‡ç¨‹äº†ã€‚ 4ã€æµ·é‡æ•°æ®åˆ†å¸ƒåœ¨100å°ç”µè„‘ä¸­ï¼Œæƒ³ä¸ªåŠæ³•é«˜æ•ˆç»Ÿè®¡å‡ºè¿™æ‰¹æ•°æ®çš„TOP10\nè§£æ³•ä¸€ï¼š\nå¦‚æœåŒä¸€ä¸ªæ•°æ®å…ƒç´ åªå‡ºç°åœ¨æŸä¸€å°æœºå™¨ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥é‡‡å–ä»¥ä¸‹æ­¥éª¤ç»Ÿè®¡å‡ºç°æ¬¡æ•°TOP10çš„æ•°æ®å…ƒç´ ï¼š\n1.å †æ’åº åœ¨æ¯å°ç”µè„‘ä¸Šæ±‚å‡ºTOP 10ï¼Œå¯ä»¥é‡‡ç”¨åŒ…å«10ä¸ªå…ƒç´ çš„å †å®Œæˆï¼ˆTOP 10å°ï¼Œç”¨æœ€å¤§å †ï¼ŒTOP 10å¤§ï¼Œç”¨æœ€å°å †ï¼Œæ¯”å¦‚æ±‚TOP10å¤§ï¼Œæˆ‘ä»¬é¦–å…ˆå–å‰10ä¸ªå…ƒç´ è°ƒæ•´æˆæœ€å°å †ï¼Œå¦‚æœå‘ç°ï¼Œç„¶åæ‰«æåé¢çš„æ•°æ®ï¼Œå¹¶ä¸å †é¡¶å…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœæ¯”å †é¡¶å…ƒç´ å¤§ï¼Œé‚£ä¹ˆç”¨è¯¥å…ƒç´ æ›¿æ¢å †é¡¶ï¼Œç„¶åå†è°ƒæ•´ä¸ºæœ€å°å †ã€‚æœ€åå †ä¸­çš„å…ƒç´ å°±æ˜¯TOP 10å¤§ï¼‰ã€‚ 2.ç»„åˆå½’å¹¶ æ±‚å‡ºæ¯å°ç”µè„‘ä¸Šçš„TOP 10åï¼Œç„¶åæŠŠè¿™100å°ç”µè„‘ä¸Šçš„TOP 10ç»„åˆèµ·æ¥ï¼Œå…±1000ä¸ªæ•°æ®ï¼Œå†åˆ©ç”¨ä¸Šé¢ç±»ä¼¼çš„æ–¹æ³•æ±‚å‡ºTOP 10å°±å¯ä»¥äº†ã€‚ è§£æ³•äºŒï¼š\nä½†å¦‚æœåŒä¸€ä¸ªå…ƒç´ é‡å¤å‡ºç°åœ¨ä¸åŒçš„ç”µè„‘ä¸­å‘¢ï¼Œæ¯”å¦‚æ‹¿ä¸¤å°æœºå™¨æ±‚top 2çš„æƒ…å†µæ¥è¯´ï¼š\nç¬¬ä¸€å°çš„æ•°æ®åˆ†å¸ƒåŠå„è‡ªå‡ºç°é¢‘ç‡ä¸ºï¼ša(50)ï¼Œb(50)ï¼Œc(49)ï¼Œd(49) ï¼Œe(0)ï¼Œf(0) å…¶ä¸­ï¼Œæ‹¬å·é‡Œçš„æ•°å­—ä»£è¡¨æŸä¸ªæ•°æ®å‡ºç°çš„é¢‘ç‡ï¼Œå¦‚a(50)è¡¨ç¤ºaå‡ºç°äº†50æ¬¡ã€‚ ç¬¬äºŒå°çš„æ•°æ®åˆ†å¸ƒåŠå„è‡ªå‡ºç°é¢‘ç‡ä¸ºï¼ša(0)ï¼Œb(0)ï¼Œc(49)ï¼Œd(49)ï¼Œe(50)ï¼Œf(50) è¿™ä¸ªæ—¶å€™ï¼Œä½ å¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•ï¼š\néå†ä¸€éæ‰€æœ‰æ•°æ®ï¼Œé‡æ–°hashå–æ‘¸ï¼Œå¦‚æ­¤ä½¿å¾—åŒä¸€ä¸ªå…ƒç´ åªå‡ºç°åœ¨å•ç‹¬çš„ä¸€å°ç”µè„‘ä¸­ï¼Œç„¶åé‡‡ç”¨ä¸Šé¢æ‰€è¯´çš„æ–¹æ³•ï¼Œç»Ÿè®¡æ¯å°ç”µè„‘ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°æ‰¾å‡ºTOP 10ï¼Œç»§è€Œç»„åˆ100å°ç”µè„‘ä¸Šçš„TOP 10ï¼Œæ‰¾å‡ºæœ€ç»ˆçš„TOP 10ã€‚ æˆ–è€…ï¼Œæš´åŠ›æ±‚è§£ï¼šç›´æ¥ç»Ÿè®¡ç»Ÿè®¡æ¯å°ç”µè„‘ä¸­å„ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°ï¼Œç„¶åæŠŠåŒä¸€ä¸ªå…ƒç´ åœ¨ä¸åŒæœºå™¨ä¸­çš„å‡ºç°æ¬¡æ•°ç›¸åŠ ï¼Œæœ€ç»ˆä»æ‰€æœ‰æ•°æ®ä¸­æ‰¾å‡ºTOP 10ã€‚ 5ã€æœ‰10ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶1Gï¼Œæ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸€è¡Œå­˜æ”¾çš„éƒ½æ˜¯ç”¨æˆ·çš„queryï¼Œæ¯ä¸ªæ–‡ä»¶çš„queryéƒ½å¯èƒ½é‡å¤ã€‚è¦æ±‚ä½ æŒ‰ç…§queryçš„é¢‘åº¦æ’åº\nè§£æ³•ä¸€ï¼š\n1.hashæ˜ å°„ é¡ºåºè¯»å–10ä¸ªæ–‡ä»¶ï¼ŒæŒ‰ç…§hash(query)%10çš„ç»“æœå°†queryå†™å…¥åˆ°å¦å¤–10ä¸ªæ–‡ä»¶ï¼ˆè®°ä¸ºa0,a1,..a9ï¼‰ä¸­ã€‚è¿™æ ·æ–°ç”Ÿæˆçš„æ–‡ä»¶æ¯ä¸ªçš„å¤§å°å¤§çº¦ä¹Ÿ1Gï¼ˆå‡è®¾hashå‡½æ•°æ˜¯éšæœºçš„ï¼‰ã€‚ 2.hash_mapç»Ÿè®¡ æ‰¾ä¸€å°å†…å­˜åœ¨2Gå·¦å³çš„æœºå™¨ï¼Œä¾æ¬¡å¯¹ç”¨hash_map(query, query_count)æ¥ç»Ÿè®¡æ¯ä¸ªqueryå‡ºç°çš„æ¬¡æ•°ã€‚æ³¨ï¼šhash_map(query, query_count)æ˜¯ç”¨æ¥ç»Ÿè®¡æ¯ä¸ªqueryçš„å‡ºç°æ¬¡æ•°ï¼Œä¸æ˜¯å­˜å‚¨ä»–ä»¬çš„å€¼ï¼Œå‡ºç°ä¸€æ¬¡ï¼Œåˆ™count+1ã€‚ 3.å †/å¿«é€Ÿ/å½’å¹¶æ’åº åˆ©ç”¨å¿«é€Ÿ/å †/å½’å¹¶æ’åºæŒ‰ç…§å‡ºç°æ¬¡æ•°è¿›è¡Œæ’åºï¼Œå°†æ’åºå¥½çš„queryå’Œå¯¹åº”çš„query_coutè¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å¾—åˆ°äº†10ä¸ªæ’å¥½åºçš„æ–‡ä»¶ï¼ˆè®°ä¸º ï¼‰ã€‚æœ€åï¼Œå¯¹è¿™10ä¸ªæ–‡ä»¶è¿›è¡Œå½’å¹¶æ’åºï¼ˆå†…æ’åºä¸å¤–æ’åºç›¸ç»“åˆï¼‰ã€‚ è§£æ³•äºŒï¼š\nä¸€èˆ¬queryçš„æ€»é‡æ˜¯æœ‰é™çš„ï¼Œåªæ˜¯é‡å¤çš„æ¬¡æ•°æ¯”è¾ƒå¤šè€Œå·²ï¼Œå¯èƒ½å¯¹äºæ‰€æœ‰çš„queryï¼Œä¸€æ¬¡æ€§å°±å¯ä»¥åŠ å…¥åˆ°å†…å­˜äº†ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨trieæ ‘/hash_mapç­‰ç›´æ¥æ¥ç»Ÿè®¡æ¯ä¸ªqueryå‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åæŒ‰å‡ºç°æ¬¡æ•°åšå¿«é€Ÿ/å †/å½’å¹¶æ’åºå°±å¯ä»¥äº†ã€‚\nè§£æ³•ä¸‰ï¼š\nä¸è§£æ³•1ç±»ä¼¼ï¼Œä½†åœ¨åšå®Œhashï¼Œåˆ†æˆå¤šä¸ªæ–‡ä»¶åï¼Œå¯ä»¥äº¤ç»™å¤šä¸ªæ–‡ä»¶æ¥å¤„ç†ï¼Œé‡‡ç”¨åˆ†å¸ƒå¼çš„æ¶æ„æ¥å¤„ç†ï¼ˆæ¯”å¦‚MapReduceï¼‰ï¼Œæœ€åå†è¿›è¡Œåˆå¹¶ã€‚\n6ã€ç»™å®šaã€bä¸¤ä¸ªæ–‡ä»¶ï¼Œå„å­˜æ”¾50äº¿ä¸ªurlï¼Œæ¯ä¸ªurlå„å 64å­—èŠ‚ï¼Œå†…å­˜é™åˆ¶æ˜¯4Gï¼Œè®©ä½ æ‰¾å‡ºaã€bæ–‡ä»¶å…±åŒçš„urlï¼Ÿ\nè§£æ³•ï¼š\nå¯ä»¥ä¼°è®¡æ¯ä¸ªæ–‡ä»¶å®‰çš„å¤§å°ä¸º5GÃ—64=320Gï¼Œè¿œè¿œå¤§äºå†…å­˜é™åˆ¶çš„4Gã€‚æ‰€ä»¥ä¸å¯èƒ½å°†å…¶å®Œå…¨åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ã€‚è€ƒè™‘é‡‡å–åˆ†è€Œæ²»ä¹‹çš„æ–¹æ³•ã€‚\n1.åˆ†è€Œæ²»ä¹‹/hashæ˜ å°„ éå†æ–‡ä»¶aï¼Œå¯¹æ¯ä¸ªurlæ±‚å– ï¼Œç„¶åæ ¹æ®æ‰€å–å¾—çš„å€¼å°†urlåˆ†åˆ«å­˜å‚¨åˆ°1000ä¸ªå°æ–‡ä»¶ï¼ˆè®°ä¸º ï¼Œè¿™é‡Œæ¼å†™ä¸ªäº†a1ï¼‰ä¸­ã€‚è¿™æ ·æ¯ä¸ªå°æ–‡ä»¶çš„å¤§çº¦ä¸º300Mã€‚éå†æ–‡ä»¶bï¼Œé‡‡å–å’Œaç›¸åŒçš„æ–¹å¼å°†urlåˆ†åˆ«å­˜å‚¨åˆ°1000å°æ–‡ä»¶ä¸­ï¼ˆè®°ä¸º ï¼‰ã€‚è¿™æ ·å¤„ç†åï¼Œæ‰€æœ‰å¯èƒ½ç›¸åŒçš„urléƒ½åœ¨å¯¹åº”çš„å°æ–‡ä»¶ï¼ˆ ï¼‰ä¸­ï¼Œä¸å¯¹åº”çš„å°æ–‡ä»¶ä¸å¯èƒ½æœ‰ç›¸åŒçš„urlã€‚ç„¶åæˆ‘ä»¬åªè¦æ±‚å‡º1000å¯¹å°æ–‡ä»¶ä¸­ç›¸åŒçš„urlå³å¯ã€‚ 2.hash_setç»Ÿè®¡ æ±‚æ¯å¯¹å°æ–‡ä»¶ä¸­ç›¸åŒçš„urlæ—¶ï¼Œå¯ä»¥æŠŠå…¶ä¸­ä¸€ä¸ªå°æ–‡ä»¶çš„urlå­˜å‚¨åˆ°hash_setä¸­ã€‚ç„¶åéå†å¦ä¸€ä¸ªå°æ–‡ä»¶çš„æ¯ä¸ªurlï¼Œçœ‹å…¶æ˜¯å¦åœ¨åˆšæ‰æ„å»ºçš„hash_setä¸­ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°±æ˜¯å…±åŒçš„urlï¼Œå­˜åˆ°æ–‡ä»¶é‡Œé¢å°±å¯ä»¥äº†ã€‚ 7ã€100ä¸‡ä¸ªæ•°ä¸­æ‰¾å‡ºæœ€å¤§çš„100ä¸ªæ•°\nè§£æ³•ä¸€ï¼šé‡‡ç”¨å±€éƒ¨æ·˜æ±°æ³•ã€‚é€‰å–å‰100ä¸ªå…ƒç´ ï¼Œå¹¶æ’åºï¼Œè®°ä¸ºåºåˆ—Lã€‚ç„¶åä¸€æ¬¡æ‰«æå‰©ä½™çš„å…ƒç´ xï¼Œä¸æ’å¥½åºçš„100ä¸ªå…ƒç´ ä¸­æœ€å°çš„å…ƒç´ æ¯”ï¼Œå¦‚æœæ¯”è¿™ä¸ªæœ€å°çš„è¦å¤§ï¼Œé‚£ä¹ˆæŠŠè¿™ä¸ªæœ€å°çš„å…ƒç´ åˆ é™¤ï¼Œå¹¶æŠŠxåˆ©ç”¨æ’å…¥æ’åºçš„æ€æƒ³ï¼Œæ’å…¥åˆ°åºåˆ—Lä¸­ã€‚ä¾æ¬¡å¾ªç¯ï¼ŒçŸ¥é“æ‰«æäº†æ‰€æœ‰çš„å…ƒç´ ã€‚å¤æ‚åº¦ä¸ºO(100ä¸‡*100)ã€‚\nè§£æ³•äºŒï¼šé‡‡ç”¨å¿«é€Ÿæ’åºçš„æ€æƒ³ï¼Œæ¯æ¬¡åˆ†å‰²ä¹‹ååªè€ƒè™‘æ¯”ä¸»å…ƒå¤§çš„ä¸€éƒ¨åˆ†ï¼Œç›´åˆ°æ¯”ä¸»å…ƒå¤§çš„ä¸€éƒ¨åˆ†æ¯”100å¤šçš„æ—¶å€™ï¼Œé‡‡ç”¨ä¼ ç»Ÿæ’åºç®—æ³•æ’åºï¼Œå–å‰100ä¸ªã€‚å¤æ‚åº¦ä¸ºO(100ä¸‡*100)ã€‚\nè§£æ³•ä¸‰ï¼šåœ¨å‰é¢çš„é¢˜ä¸­ï¼Œæˆ‘ä»¬å·²ç»æåˆ°äº†ï¼Œç”¨ä¸€ä¸ªå«100ä¸ªå…ƒç´ çš„æœ€å°å †å®Œæˆã€‚å¤æ‚åº¦ä¸ºO(100ä¸‡*lg100)ã€‚\nä¸¾ä¸€åä¸‰ #1ã€æ€ä¹ˆåœ¨æµ·é‡æ•°æ®ä¸­æ‰¾å‡ºé‡å¤æ¬¡æ•°æœ€å¤šçš„ä¸€ä¸ªï¼Ÿ\næç¤ºï¼šå…ˆåšhashï¼Œç„¶åæ±‚æ¨¡æ˜ å°„ä¸ºå°æ–‡ä»¶ï¼Œæ±‚å‡ºæ¯ä¸ªå°æ–‡ä»¶ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„ä¸€ä¸ªï¼Œå¹¶è®°å½•é‡å¤æ¬¡æ•°ã€‚ç„¶åæ‰¾å‡ºä¸Šä¸€æ­¥æ±‚å‡ºçš„æ•°æ®ä¸­é‡å¤æ¬¡æ•°æœ€å¤šçš„ä¸€ä¸ªå°±æ˜¯æ‰€æ±‚ï¼ˆå…·ä½“å‚è€ƒå‰é¢çš„é¢˜ï¼‰ã€‚\n2ã€ä¸Šåƒä¸‡æˆ–ä¸Šäº¿æ•°æ®ï¼ˆæœ‰é‡å¤ï¼‰ï¼Œç»Ÿè®¡å…¶ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å‰Nä¸ªæ•°æ®ã€‚\næç¤ºï¼šä¸Šåƒä¸‡æˆ–ä¸Šäº¿çš„æ•°æ®ï¼Œç°åœ¨çš„æœºå™¨çš„å†…å­˜åº”è¯¥èƒ½å­˜ä¸‹ã€‚æ‰€ä»¥è€ƒè™‘é‡‡ç”¨hash_map/æœç´¢äºŒå‰æ ‘/çº¢é»‘æ ‘ç­‰æ¥è¿›è¡Œç»Ÿè®¡æ¬¡æ•°ã€‚ç„¶åå°±æ˜¯å–å‡ºå‰Nä¸ªå‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•°æ®äº†ï¼Œå¯ä»¥ç”¨ç¬¬2é¢˜æåˆ°çš„å †æœºåˆ¶å®Œæˆã€‚\n3ã€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå¤§çº¦æœ‰ä¸€ä¸‡è¡Œï¼Œæ¯è¡Œä¸€ä¸ªè¯ï¼Œè¦æ±‚ç»Ÿè®¡å‡ºå…¶ä¸­æœ€é¢‘ç¹å‡ºç°çš„å‰10ä¸ªè¯ï¼Œè¯·ç»™å‡ºæ€æƒ³ï¼Œç»™å‡ºæ—¶é—´å¤æ‚åº¦åˆ†æã€‚\næç¤ºï¼šè¿™é¢˜æ˜¯è€ƒè™‘æ—¶é—´æ•ˆç‡ã€‚ç”¨trieæ ‘ç»Ÿè®¡æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n*le)ï¼ˆleè¡¨ç¤ºå•è¯çš„å¹³å‡†é•¿åº¦ï¼‰ã€‚ç„¶åæ˜¯æ‰¾å‡ºå‡ºç°æœ€é¢‘ç¹çš„å‰10ä¸ªè¯ï¼Œå¯ä»¥ç”¨å †æ¥å®ç°ï¼Œå‰é¢çš„é¢˜ä¸­å·²ç»è®²åˆ°äº†ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n*lg10)ã€‚æ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ˜¯O(n*le)ä¸O(n*lg10)ä¸­è¾ƒå¤§çš„å“ªä¸€ä¸ªã€‚\n4ã€1000ä¸‡å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æœ‰äº›æ˜¯é‡å¤çš„ï¼Œéœ€è¦æŠŠé‡å¤çš„å…¨éƒ¨å»æ‰ï¼Œä¿ç•™æ²¡æœ‰é‡å¤çš„å­—ç¬¦ä¸²ã€‚è¯·æ€ä¹ˆè®¾è®¡å’Œå®ç°ï¼Ÿ\næç¤ºï¼šè¿™é¢˜ç”¨trieæ ‘æ¯”è¾ƒåˆé€‚ï¼Œhash_mapä¹Ÿè¡Œã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å…ˆhashæˆå°æ–‡ä»¶åˆ†å¼€å¤„ç†å†ç»¼åˆã€‚\n5ã€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ‰¾å‡ºå‰10ä¸ªç»å¸¸å‡ºç°çš„è¯ï¼Œä½†è¿™æ¬¡æ–‡ä»¶æ¯”è¾ƒé•¿ï¼Œè¯´æ˜¯ä¸Šäº¿è¡Œæˆ–åäº¿è¡Œï¼Œæ€»ä¹‹æ— æ³•ä¸€æ¬¡è¯»å…¥å†…å­˜ï¼Œé—®æœ€ä¼˜è§£ã€‚\næç¤ºï¼šé¦–å…ˆæ ¹æ®ç”¨hashå¹¶æ±‚æ¨¡ï¼Œå°†æ–‡ä»¶åˆ†è§£ä¸ºå¤šä¸ªå°æ–‡ä»¶ï¼Œå¯¹äºå•ä¸ªæ–‡ä»¶åˆ©ç”¨ä¸Šé¢˜çš„æ–¹æ³•æ±‚å‡ºæ¯ä¸ªæ–‡ä»¶ä»¶ä¸­10ä¸ªæœ€å¸¸å‡ºç°çš„è¯ã€‚ç„¶åå†è¿›è¡Œå½’å¹¶å¤„ç†ï¼Œæ‰¾å‡ºæœ€ç»ˆçš„10ä¸ªæœ€å¸¸å‡ºç°çš„è¯ã€‚\nåŸæ–‡åœ°å€ï¼šç¼–ç¨‹ä¹‹æ³•ï¼šé¢è¯•å’Œç®—æ³•å¿ƒå¾—-åˆ†è€Œæ²»ä¹‹\n","date":"16 December 2017","permalink":"/hai-liang-shu-ju-chu-li-fen-er-zhi-zhi/","section":"Posts","summary":"\u003ch3 id=\"æ–¹æ³•ä»‹ç»\" class=\"relative group\"\u003eæ–¹æ³•ä»‹ç» \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%e6%96%b9%e6%b3%95%e4%bb%8b%e7%bb%8d\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h3\u003e\u003cp\u003eå¯¹äºæµ·é‡æ•°æ®è€Œè¨€ï¼Œç”±äºæ— æ³•ä¸€æ¬¡æ€§è£…è¿›å†…å­˜å¤„ç†ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸å¾—ä¸æŠŠæµ·é‡çš„æ•°æ®é€šè¿‡hashæ˜ å°„åˆ†å‰²æˆç›¸åº”çš„å°å—æ•°æ®ï¼Œç„¶åå†é’ˆå¯¹å„ä¸ªå°å—æ•°æ®é€šè¿‡hash_mapè¿›è¡Œç»Ÿè®¡æˆ–å…¶å®ƒæ“ä½œã€‚\u003c/p\u003e","title":"ã€è½¬è½½ã€‘æµ·é‡æ•°æ®å¤„ç†ä¹‹ã€Œåˆ†è€Œæ²»ä¹‹ã€"},{"content":"","date":null,"permalink":"/tags/tcp/","section":"Tags","summary":"","title":"Tcp"},{"content":"æœ€è¿‘åœ¨è¡¥å……HTTP/TCPåè®®çš„ä¸€äº›çŸ¥è¯†ã€‚çœ‹åˆ°ã€ŠHTTPæƒå¨æŒ‡å—ã€‹ä¸­TCPè¿æ¥æ—¶è§‰å¾—ä¸‹å›¾æè¿°çš„æ¯”ä¹‹å‰çœ‹å…¶ä»–äººå†™çš„åšæ–‡è¦æ¸…æ¥šçš„å¤šã€‚\nå›¾ï¼šTCPå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•é€šè¿‡TCPå¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„\nåœ¨å‘é€æ•°æ®å‰ï¼ŒTCPè¦ç©¿é€ä¸¤ä¸ªåˆ†ç»„æ¥å»ºç«‹è¿æ¥ï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„ä¸‰æ¬¡æ¡æ‰‹ã€‚\nç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€synåŒ…(syn=j)åˆ°æœåŠ¡å™¨ï¼Œå¹¶è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼›\nç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°synåŒ…ï¼Œå¿…é¡»ç¡®è®¤å®¢æˆ·çš„SYNï¼ˆack=j+1ï¼‰ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿå‘é€ä¸€ä¸ªSYNåŒ…ï¼ˆsyn=kï¼‰ï¼Œå³SYN+ACKåŒ…ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ï¼›\nç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYNï¼‹ACKåŒ…ï¼ŒéªŒè¯ack=j+1ï¼Œå¹¶å‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…ACK(ack=k+1)ï¼Œæ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å¼€å§‹ä¼ é€æ•°æ®ã€‚\n","date":"16 November 2017","permalink":"/tcp-client-server-connection/","section":"Posts","summary":"\u003cp\u003eæœ€è¿‘åœ¨è¡¥å……HTTP/TCPåè®®çš„ä¸€äº›çŸ¥è¯†ã€‚çœ‹åˆ°ã€ŠHTTPæƒå¨æŒ‡å—ã€‹ä¸­TCPè¿æ¥æ—¶è§‰å¾—ä¸‹å›¾æè¿°çš„æ¯”ä¹‹å‰çœ‹å…¶ä»–äººå†™çš„åšæ–‡è¦æ¸…æ¥šçš„å¤šã€‚\u003c/p\u003e","title":"TCPå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ˜¯å¦‚ä½•é€šè¿‡TCPå¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„"},{"content":"","date":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux"},{"content":"","date":null,"permalink":"/tags/lnmp/","section":"Tags","summary":"","title":"LNMP"},{"content":"ä»Šå¤©çœ‹ PHP å®˜ç½‘ 7.1.3 çš„ç¨³å®šç‰ˆå·²ç»å‡ºæ¥äº†ï¼Œå‡†å¤‡å°å°é²œï¼Œå®‰è£…è¿‡ç¨‹æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œè¿™é‡Œåªæ˜¯ç®€å•è®°å½•ä¸‹ã€‚\nå®‰è£… nginx 1.8 #æ·»åŠ å®˜æ–¹ yum æº #nginx æä¾›äº†å®˜æ–¹çš„ yum æºï¼Œå®‰è£… nginx çš„ 1.8 å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ yum æºï¼Œé€Ÿåº¦è¿˜ä¸é”™ã€‚\nåœ¨ /etc/yum.repo.d/ ä¸‹æ–°å»ºæ–‡ä»¶ nginx.repo\n[nginx] name=nginx repo baseurl=http://nginx.org/packages/centos/$releasever/$basearch/ gpgcheck=0 enabled=1 ubuntu/debian æºå…·ä½“å‚è§ï¼šå®˜æ–¹æ–‡æ¡£\nå®‰è£… nginx #ä½¿ç”¨ yum install nginx å®‰è£…ï¼Œyum ä¼šæŸ¥æ‰¾è½¯ä»¶åŒ…å’Œä¾èµ–ç„¶åæç¤ºæ˜¯å¦å®‰è£…ï¼Œçœ‹å¥½ç‰ˆæœ¬åï¼Œé€‰æ‹© Yã€‚\n/etc/init.d/nginx start å¯ä»¥ä½¿ç”¨ curl localhost éªŒè¯ nginx æ˜¯å¦å®‰è£…æˆåŠŸã€‚\nå®‰è£… PHP7 #æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰å®‰è£… MySQL çš„è¯ï¼Œæœ€å¥½å…ˆå®‰è£…ä¸€ä¸‹ MySQLã€‚\nå®‰è£…ä¾èµ– #yum install -y libxml2 libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers php-mysqlnd libmcrypt-devel libtidy libtidy-devel recode recode-devel libxpm-devel libXpm-devel å®‰è£… libmcryptï¼š\nwget ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/libmcrypt-2.5.6.tar.gz tar -zxvf libmcrypt-2.5.6.tar.gz cd libmcrypt-2.5.6.tar. make \u0026amp;\u0026amp; make install é»˜è®¤ä¼šå®‰è£…åœ¨ /usr/local ç›®å½•ä¸‹ã€‚\nä¸‹è½½ PHP æºç åŒ… #æˆ‘è¿™é‡Œæ˜¯å®‰è£…çš„å®˜æ–¹æœ€æ–°ç¨³å®šç‰ˆ PHP7.1.3ï¼Œæ‰€ä»¥å°†ä½¿ç”¨æºç å®‰è£…æ–¹å¼å®‰è£…ã€‚\nwget http://cn.php.net/distributions/php-7.1.3.tar.gz tar -xzvf php-7.1.3.tar.gz cd php-7.1.3 ç¼–è¯‘é…ç½®ï¼ˆå½“å‰åº”è¯¥åœ¨ php-7.1.3 ç›®å½•ä¸‹ï¼‰ï¼š\n./configure --prefix=/usr/local/php --with-fpm-user=nginx --with-fpm-group=nginx --with-config-file-path=/etc/php --with-mysql=mysqlnd --with-pdo-mysql=mysqlnd --with-mysqli=mysqlnd --with-gd --with-iconv --with-zlib --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-fpm --enable-mbstring --enable-ftp --enable-gd-native-ttf --with-openssl --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --enable-session --with-mcrypt --with-curl --with-jpeg-dir --with-freetype-dir --with-xpm-dir=/usr --with-bz2 ç¼–è¯‘ï¼š\nmake è¿™é‡Œå¯èƒ½ä¼šç­‰æŒºé•¿æ—¶é—´ï¼Œå®‰è£…è¿‡ç¨‹å¤§æ¦‚å°±æ˜¯å¤åˆ¶ç¼–è¯‘åçš„æ–‡ä»¶çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚\nmake test \u0026amp; make install è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå‰é¢ configure æ—¶æˆ‘ä»¬é…ç½®äº† php.ini çš„è·¯å¾„ä¸º /etc/phpï¼Œç„¶è€Œå‘ç°å¹¶æ²¡æœ‰è¿™ä¸ªç›®å½•ä¹Ÿæ‰¾ä¸åˆ° php.ini æ–‡ä»¶ã€‚æ²¡å…³ç³»ï¼Œè¿™é‡Œå¯ä»¥æ‰‹åŠ¨çš„å¤åˆ¶ä¸€ä¸ªé…ç½®æ–‡ä»¶è¿‡å»ï¼Œé…ç½®æ–‡ä»¶å¯ä»¥åœ¨æºç åŒ… php-7.1.3 é‡Œæ‰¾åˆ°ï¼Œå®ƒåŒ…æ‹¬äº†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„é»˜è®¤é…ç½®ã€‚\n#å¼€å‘ç¯å¢ƒ cp ~/php-7.1.3/php.ini-development ./php.ini #ç”Ÿäº§ç¯å¢ƒ cp ~/php-7.1.3/php.ini-production ./php.ini é…ç½® nginx #ä¿®æ”¹ /etc/nginx/conf.d/default.conf æ–‡ä»¶\n... location / { root /var/www; index index.html index.htmi index.php; } ... # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # location ~ .php$ { # æ ¹ç›®å½• root root /var/www; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } é…ç½® php-fpm #cp /local/php/etc/php-fpm.conf.default /local/php/etc/php-fpm.conf cp /local/php/etc/php-fpm.d/www.conf.default /local/php/etc/php-fpm.d/www.conf ä¸ºäº†æ›´æ–¹ä¾¿çš„å¯åŠ¨ php-fpmï¼Œæˆ‘ä»¬ä¸ºå®ƒæ·»åŠ  sysv é£æ ¼çš„åˆå§‹åŒ–æœåŠ¡è„šæœ¬ï¼Œnginx æ˜¯é€šè¿‡ yum å®‰è£…çš„æ˜¯æœ‰ /etc/init.d/nginx è¿™ä¸ªå¯åŠ¨è„šæœ¬çš„ã€‚\næ–°å»ºæ–‡ä»¶ /etc/init.d/php-fpmï¼š\n#!/bin/bash # # Startup script for the PHP-FPM server. # # chkconfig: 345 85 15 # description: PHP is an HTML-embedded scripting language # processname: php-fpm # config: /usr/local/php/etc/php.ini # Source function library. . /etc/rc.d/init.d/functions PHP_PATH=/usr/local DESC=\u0026#34;php-fpm daemon\u0026#34; NAME=php-fpm # php-fpmè·¯å¾„ DAEMON=$PHP_PATH/php/sbin/$NAME # é…ç½®æ–‡ä»¶è·¯å¾„ CONFIGFILE=$PHP_PATH/php/etc/php-fpm.conf # PIDæ–‡ä»¶è·¯å¾„ä¸æ¸…æ¥šå¯ä»¥æŸ¥çœ‹ /usr/local/php/etc/php-fpm.conf PIDFILE=$PHP_PATH/php/var/run/$NAME.pid SCRIPTNAME=/etc/init.d/$NAME # Gracefully exit if the package has been removed. test -x $DAEMON || exit 0 rh_start() { $DAEMON -y $CONFIGFILE || echo -n \u0026#34; already running\u0026#34; } rh_stop() { kill -QUIT `cat $PIDFILE` || echo -n \u0026#34; not running\u0026#34; } rh_reload() { kill -HUP `cat $PIDFILE` || echo -n \u0026#34; can\u0026#39;t reload\u0026#34; } case \u0026#34;$1\u0026#34; in start) echo -n \u0026#34;Starting $DESC: $NAME\u0026#34; rh_start echo \u0026#34;.\u0026#34; ;; stop) echo -n \u0026#34;Stopping $DESC: $NAME\u0026#34; rh_stop echo \u0026#34;.\u0026#34; ;; reload) echo -n \u0026#34;Reloading $DESC configuration...\u0026#34; rh_reload echo \u0026#34;reloaded.\u0026#34; ;; restart) echo -n \u0026#34;Restarting $DESC: $NAME\u0026#34; rh_stop sleep 1 rh_start echo \u0026#34;.\u0026#34; ;; *) echo \u0026#34;Usage: $SCRIPTNAME {start|stop|restart|reload}\u0026#34; \u0026gt;\u0026amp;2 exit 3 ;; esac exit 0 # èµ‹äºˆæ‰§è¡Œæƒé™ sudo chmod +x /etc/init.d/php-fpm # ä¿®æ”¹å¯åŠ¨ç­‰çº§ sudo /sbin/chkconfig php-fpm on ä¸‹é¢å°±å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æ§åˆ¶ php-fpm äº†\n/etc/init.d/php-fpm start /etc/init.d/php-fpm stop /etc/init.d/php-fpm restart /etc/init.d/php-fpm reload å¯åŠ¨ php-fpm åå°±å¯æµ‹è¯•ä¸€ä¸‹ PHP æ–‡ä»¶èƒ½å¦æ‰§è¡Œäº†ã€‚\næœ‰é—®é¢˜å¯ç•™è¨€\nå‚è€ƒèµ„æ–™ #nginx æ–‡æ¡£\nNginxå’ŒPHP-FPMçš„å¯åŠ¨/é‡å¯è„šæœ¬\n","date":"8 October 2017","permalink":"/centos-6-8-install-nginx-stable-and-php7/","section":"Posts","summary":"\u003cp\u003eä»Šå¤©çœ‹ PHP å®˜ç½‘ 7.1.3 çš„ç¨³å®šç‰ˆå·²ç»å‡ºæ¥äº†ï¼Œå‡†å¤‡å°å°é²œï¼Œå®‰è£…è¿‡ç¨‹æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œè¿™é‡Œåªæ˜¯ç®€å•è®°å½•ä¸‹ã€‚\u003c/p\u003e","title":"æ—¥å¸¸æŠ˜è…¾ç¯å¢ƒğŸ˜‚Nginx + PHP 7.1.3"},{"content":"","date":null,"permalink":"/tags/pwa/","section":"Tags","summary":"","title":"PWA"},{"content":"Ghost åšå®¢æ”¯æŒ Progressive Web Apps ï¼ˆPWAï¼‰ #ä¸€ç›´å¯¹ Google çš„ Progressive Web Apps ï¼ˆä»¥ä¸‹ç®€ç§° PWAï¼‰ æœ‰ç‚¹å…´è¶£ï¼Œæ‰€ä»¥æ‹¿æˆ‘çš„åšå®¢åšå®éªŒï¼Œè®© Ghost åšå®¢æ”¯æŒ PWAã€‚\nPSï¼šå¦‚æœä½ çš„åšå®¢è¿˜ä¸æ”¯æŒ https çš„è¯ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¸æ”¯æŒ Service Workerï¼Œä¹Ÿå°±æ˜¯è¯´å®ç°ä¸äº† Progressive Web Appsã€‚\nå¦‚æœå¯¹ PWA ä¸æ˜¯å¾ˆäº†è§£ï¼Œå»ºè®®å…ˆé˜…è¯»ï¼š\nä½ çš„é¦–ä¸ªProgressive Web App [English] [ä¸­æ–‡] ä¸‹ä¸€ä»£ Web åº”ç”¨æ¨¡å‹ â€”â€” Progressive Web App Service worker æ¦‚å¿µå’Œç”¨æ³• Service Worker Tools æ·»åŠ  Service Worker Toolbox #åœ¨ä¸»é¢˜ç›®å½•ä¸‹ï¼ˆé»˜è®¤ä¸º ghost/content/themes/casperï¼‰çš„ assets æ–°å»º dist ç›®å½•ã€‚\nåœ¨è¯¥ç›®å½•æ·»åŠ  sw-toolbox.js æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åœ¨è¿™é‡Œ\n###æ·»åŠ ç¼“å­˜è„šæœ¬\nåœ¨æ‚¨çš„ä¸»é¢˜æ ¹ç›®å½•ä¸‹åˆ›å»ºåä¸ºserviceworker-v1.jsçš„æ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ serviceworker-v1.js è¿™ä¸ªæ–‡ä»¶ä¸€å®šè¦æ”¾åˆ°ç½‘ç«™æ ¹ç›®å½•ï¼Œå› ä¸ºå®ƒçš„ä½ç½®ä¹ŸæŒ‡å®šäº† Service Worker å¯æ‰§è¡Œçš„ç›®å½•æƒé™ã€‚\nåœ¨è¯¥æ–‡ä»¶ä¸­åŒ…å«ä»¥ä¸‹ä»£ç ï¼š\n\u0026#39;use strict\u0026#39;; (function () { \u0026#39;use strict\u0026#39;; /** * Service Worker Toolbox caching */ var cacheVersion = \u0026#39;-toolbox-v1\u0026#39;; var dynamicVendorCacheName = \u0026#39;dynamic-vendor\u0026#39; + cacheVersion; var staticVendorCacheName = \u0026#39;static-vendor\u0026#39; + cacheVersion; var staticAssetsCacheName = \u0026#39;static-assets\u0026#39; + cacheVersion; var contentCacheName = \u0026#39;content\u0026#39; + cacheVersion; var maxEntries = 50; self.importScripts(\u0026#39;assets/dist/sw-toolbox.js\u0026#39;); self.toolbox.options.debug = false; // Cache own static assets self.toolbox.router.get(\u0026#39;/assets/(.*)\u0026#39;, self.toolbox.cacheFirst, { cache: { name: staticAssetsCacheName, maxEntries: maxEntries } }); // cache dynamic vendor assets, things which have no other update mechanism like filename change/version hash self.toolbox.router.get(\u0026#39;/css\u0026#39;, self.toolbox.fastest, { origin: /fonts\\.googleapis\\.com/, cache: { name: dynamicVendorCacheName, maxEntries: maxEntries } }); // Do not cache disqus self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.networkOnly, { origin: /disqus\\.com/ }); self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.networkOnly, { origin: /disquscdn\\.com/ }); // Cache all static vendor assets, e.g. fonts whose version is bind to the according url self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.cacheFirst, { origin: /(fonts\\.gstatic\\.com|www\\.google-analytics\\.com)/, cache: { name: staticVendorCacheName, maxEntries: maxEntries } }); self.toolbox.router.get(\u0026#39;/content/(.*)\u0026#39;, self.toolbox.fastest, { cache: { name: contentCacheName, maxEntries: maxEntries } }); self.toolbox.router.get(\u0026#39;/*\u0026#39;, function (request, values, options) { if (!request.url.match(/(\\/ghost\\/|\\/page\\/)/) \u0026amp;\u0026amp; request.headers.get(\u0026#39;accept\u0026#39;).includes(\u0026#39;text/html\u0026#39;)) { return self.toolbox.fastest(request, values, options); } else { return self.toolbox.networkOnly(request, values, options); } }, { cache: { name: contentCacheName, maxEntries: maxEntries } }); // immediately activate this serviceworker self.addEventListener(\u0026#39;install\u0026#39;, function (event) { return event.waitUntil(self.skipWaiting()); }); self.addEventListener(\u0026#39;activate\u0026#39;, function (event) { return event.waitUntil(self.clients.claim()); }); })(); //# sourceMappingURL=serviceworker-v1.js.map å¦‚æœåœ¨éƒ¨ç½²é˜¶æ®µï¼Œå¯ä»¥å°†ä¸Šæ®µä»£ç ä¸­çš„ self.toolbox.options.debug æ”¹ä¸º trueã€‚\nä»ä¸‹é¢è¿™æ®µä»£ç å¯ä»¥çœ‹å‡º service worker ä½¿ç”¨ Express è·¯ç”±çš„ä»£ç é£æ ¼æ¥å®šä½æŒ‡å®šçš„èµ„æºï¼š\n// ç¼“å­˜é™æ€èµ„æº self.toolbox.router.get(\u0026#39;/assets/(.*)\u0026#39;, self.toolbox.cacheFirst, { cache: { name: staticAssetsCacheName, maxEntries: maxEntries } }); æœ‰ä»¥ä¸‹å‡ ç§è·å–èµ„æºçš„æ–¹å¼ï¼š\ncacheFirstï¼ˆç¼“å­˜ä¼˜å…ˆï¼‰ï¼š å¦‚æœè¯·æ±‚ä¸ç¼“å­˜æ¡ç›®åŒ¹é…ï¼Œåˆ™å›åº”ã€‚ å¦åˆ™å°è¯•ä»ç½‘ç»œä¸­è·å–èµ„æºã€‚ å¦‚æœç½‘ç»œè¯·æ±‚æˆåŠŸï¼Œè¯·æ›´æ–°ç¼“å­˜ã€‚ æ­¤é€‰é¡¹é€‚ç”¨äºä¸æ›´æ”¹çš„èµ„æºï¼Œæˆ–å…·æœ‰å…¶ä»–æ›´æ–°æœºåˆ¶ã€‚ cacheFirstï¼ˆæœ€å¿«ï¼‰ï¼šä»ç¼“å­˜å’Œç½‘ç»œå¹¶è¡Œè¯·æ±‚èµ„æºã€‚ä»¥é¦–å…ˆå›æŠ¥çš„æ–¹å¼ä½œå‡ºå›åº”ã€‚é€šå¸¸è¿™å°†æ˜¯ç¼“å­˜çš„ç‰ˆæœ¬ï¼Œå¦‚æœæœ‰çš„è¯ã€‚ä¸€æ–¹é¢ï¼Œå³ä½¿èµ„æºè¢«ç¼“å­˜ï¼Œè¿™ä¸ªç­–ç•¥æ€»æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªç½‘ç»œè¯·æ±‚ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ/å½“ç½‘ç»œè¯·æ±‚å®Œæˆæ—¶ï¼Œç¼“å­˜è¢«æ›´æ–°ï¼Œä»¥ä¾¿å°†æ¥çš„é«˜é€Ÿç¼“å­˜è¯»å–å°†æ˜¯æ›´æ–°çš„ã€‚ networkFirstï¼ˆç½‘ç»œä¼˜å…ˆï¼‰ï¼šå°è¯•é€šè¿‡ä»ç½‘ç»œä¸­æå–æ¥å¤„ç†è¯·æ±‚ã€‚å¦‚æœæˆåŠŸï¼Œå°†å“åº”å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚ å¦åˆ™ï¼Œå°è¯•ä»ç¼“å­˜ä¸­å®Œæˆè¯·æ±‚ã€‚è¿™æ˜¯ç”¨äºåŸºæœ¬çš„ç›´è¯»ç¼“å­˜çš„ç­–ç•¥ã€‚å®ƒä¹Ÿé€‚ç”¨äºAPIè¯·æ±‚ï¼Œå½“æ‚¨å§‹ç»ˆå¸Œæœ›æœ€æ–°æ•°æ®å¯ç”¨æ—¶ï¼Œè€Œä¸æ˜¯æ²¡æœ‰æ•°æ®çš„é™ˆæ—§æ•°æ®ã€‚ cacheOnlyï¼šåªä½¿ç”¨ç¼“å­˜èµ„æº networkOnlyï¼šåªä½¿ç”¨ç½‘ç»œèµ„æº å¦‚æœæˆ‘ä»¬ä¸æƒ³ç¼“å­˜è¯„è®ºå†…å®¹ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ç½‘æ˜“äº‘è·Ÿå¸–ï¼Œå¯ä»¥æŒ‡å®šæ¥è‡ª 163.com å’Œ netease.com çš„æ–‡ä»¶çš„è¯·æ±‚å§‹ç»ˆä¸ºç½‘ç»œï¼š\n// Do not cache 163.com and netease.com self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.networkOnly, { origin: /163\\.com/ }); self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.networkOnly, { origin: /netease\\.com/ }); ç¼“å­˜ Google fonts å’Œ Google Analytics:\n// Cache all static vendor assets, e.g. fonts whose version is bind to the according url self.toolbox.router.get(\u0026#39;/(.*)\u0026#39;, self.toolbox.cacheFirst, { origin: /(fonts\\.gstatic\\.com|www\\.google-analytics\\.com)/, cache: { name: staticVendorCacheName, maxEntries: maxEntries } }); æ¿€æ´» Service Worker #åªéœ€é€šè¿‡ script æ ‡ç­¾å°†ä¸‹é¢çš„ JavaScript ä»£ç å¼•å…¥åˆ° defalut.hbs å³å¯ï¼š\nvar serviceWorkerUri = \u0026#39;/serviceworker-v1.js\u0026#39;; if (\u0026#39;serviceWorker\u0026#39; in navigator) { navigator.serviceWorker.register(serviceWorkerUri).then(function() { // Registration was successful. Now, check to see whether the service worker is controlling the page. if (navigator.serviceWorker.controller) { console.log(\u0026#39;Assets cached by the controlling service worker.\u0026#39;); } else { console.log(\u0026#39;Please reload this page to allow the service worker to handle network operations.\u0026#39;); } }).catch(function(error) { console.log(\u0026#39;ERROR: \u0026#39; + error); }); } else { // The current browser doesn\u0026#39;t support service workers. console.log(\u0026#39;Service workers are not supported in the current browser.\u0026#39;); } å¯ä»¥æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹ Service Worker çš„è¿è¡ŒçŠ¶å†µï¼Œåœ¨ Application ä¸€æ ä¸­æœ‰ Service Worker çš„é€‰é¡¹å¡ã€‚å¦‚æœå‡ºç°é”™è¯¯å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè°ƒè¯•ã€‚\næ·»åŠ åˆ°ä¸»å±å¹• #Progressive Web Apps çš„å®˜æ–¹æ–‡æ¡£æŒ‡å‡ºï¼Œå¼€å‘è€…éœ€è¦æä¾›ä¸€ä¸ª manifest.json æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘æ”¾åœ¨äº†ç½‘ç«™æ ¹ç›®å½•ï¼Œå®ƒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\n{ \u0026#34;short_name\u0026#34;: \u0026#34;Pavel\u0026#39;s Blog\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Pavel\u0026#39;s Blog\u0026#34;, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;: \u0026#34;assets/images/android-icon-144x144.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;144x144\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34;, \u0026#34;density\u0026#34;: \u0026#34;3.0\u0026#34; } ], \u0026#34;start_url\u0026#34;: \u0026#34;/\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;orientation\u0026#34;: \u0026#34;portrait\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#6595b8\u0026#34; } åœ¨ default.hbs ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š\n\u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;/manifest.json\u0026#34;\u0026gt; ä¸‹é¢åœ¨ Android Chrome ä¸­æ‰“å¼€ä½ çš„åšå®¢ï¼Œç‚¹å³ä¸Šè§’æŒ‰é’®â€”â€”\u0026gt;æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œå°±å¯ä»¥çœ‹åˆ°ç±»ä¼¼åŸç”Ÿ App çš„æ•ˆæœäº†ã€‚\næœ‰ä»»ä½•é—®é¢˜å¯ä»¥åœ¨ä¸‹æ–¹è¯„è®ºè®¨è®ºã€‚\nå‚è€ƒèµ„æ–™ #Node, Ghost, and Progressive Web Apps (PWA)\n","date":"30 September 2017","permalink":"/node-express-ghost-progressive-web-apps-pwa/","section":"Posts","summary":"\u003ch3 id=\"ghost-åšå®¢æ”¯æŒ-progressive-web-apps-pwa\" class=\"relative group\"\u003eGhost åšå®¢æ”¯æŒ Progressive Web Apps ï¼ˆPWAï¼‰ \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#ghost-%e5%8d%9a%e5%ae%a2%e6%94%af%e6%8c%81-progressive-web-apps-pwa\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h3\u003e\u003cp\u003eä¸€ç›´å¯¹ Google çš„ Progressive Web Apps ï¼ˆä»¥ä¸‹ç®€ç§° PWAï¼‰ æœ‰ç‚¹å…´è¶£ï¼Œæ‰€ä»¥æ‹¿æˆ‘çš„åšå®¢åšå®éªŒï¼Œè®© Ghost åšå®¢æ”¯æŒ PWAã€‚\u003c/p\u003e\n\u003cp\u003ePSï¼šå¦‚æœä½ çš„åšå®¢è¿˜ä¸æ”¯æŒ https çš„è¯ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¸æ”¯æŒ Service Workerï¼Œä¹Ÿå°±æ˜¯è¯´å®ç°ä¸äº† Progressive Web Appsã€‚\u003c/p\u003e","title":"è®©ä½ çš„Ghoståšå®¢æ”¯æŒProgressive Web Apps (PWA)"},{"content":"","date":null,"permalink":"/tags/php/","section":"Tags","summary":"","title":"Php"},{"content":"PHP session è·å–ä¸åˆ°ä¹‹å‰è®¾ç½®å€¼çš„é—®é¢˜ #ä»Šå¤©å¸®æœ‹å‹çš„æœåŠ¡å™¨éƒ¨ç½²ä¸€ä¸ªå°ç¨‹åºå•†åŸæ—¶é‡åˆ°ä¸€ä¸ª session æ— æ³•ä¿å­˜çš„é—®é¢˜ã€‚\nåœ¨ web çš„ä¸€ä¸ªé¡µé¢é€šè¿‡ $_SESSION è®¾ç½®çš„ session å€¼ï¼š\n$_SESSION[\u0026#39;user\u0026#39;] = \u0026#39;user\u0026#39;; var_dump($_SESSION); è®¾ç½®å®Œä¹‹åæ˜¯å¯ä»¥æ‰“å°å‡ºå€¼çš„ã€‚ä½†æ˜¯è·³è½¬åˆ°å¦ä¸€é¡µé¢å´å–ä¸åˆ° session çš„å€¼ã€‚\nè™½ç„¶session.auto_start é…ç½®ä¸º Offï¼Œä½†å·²ç»æ’é™¤äº† session_start(); æ²¡è°ƒç”¨çš„é—®é¢˜ã€‚ä¹Ÿæ²¡æœ‰é€šè¿‡ session_set_save_handler() å»è‡ªå®šä¹‰ session çš„å­˜å‚¨è¿‡ç¨‹ã€‚\né€šè¿‡ phpinfoå‡½æ•°ç»™å‡ºçš„ä¿¡æ¯ï¼Œçœ‹åˆ°äº† session.save_path é…ç½®æ˜¯ /var/lib/php/sessionï¼Œè¿›å»è¯¥ç›®å½•å‘ç°å¹¶æ²¡æœ‰ä»»ä½•æ–‡ä»¶ã€‚çœ‹åˆ°è¿™é‡Œå®šä½åˆ°åº”è¯¥æ˜¯ session ç›®å½•æƒé™é—®é¢˜ã€‚\nå®‰è£…å®Œ php-fpm ï¼Œé»˜è®¤è¿è¡Œç”¨æˆ·æ˜¯ apacheï¼Œæˆ‘ä¹‹å‰æ”¹æˆäº† nobody ï¼Œsession ç›®å½•å¿˜äº†æ”¹ï¼ˆè¿™é‡Œåº”è¯¥æå…¶å®¹æ˜“å¿˜ï¼‰ã€‚ğŸ˜‚\nè¿™é‡ŒæŠŠsessionç›®å½•æƒé™æ”¹ä¸‹å°±å¥½äº†ã€‚ç¯å¢ƒé—®é¢˜æœ‰æ—¶å€™çœŸçš„æ˜¯é˜²ä¸èƒœé˜²å•ŠğŸ˜‚\n","date":"5 May 2017","permalink":"/php-session-%E8%8E%B7%E5%8F%96%E4%B8%8D%E5%88%B0/","section":"Posts","summary":"\u003ch3 id=\"php-session-è·å–ä¸åˆ°ä¹‹å‰è®¾ç½®å€¼çš„é—®é¢˜\" class=\"relative group\"\u003ePHP session è·å–ä¸åˆ°ä¹‹å‰è®¾ç½®å€¼çš„é—®é¢˜ \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#php-session-%e8%8e%b7%e5%8f%96%e4%b8%8d%e5%88%b0%e4%b9%8b%e5%89%8d%e8%ae%be%e7%bd%ae%e5%80%bc%e7%9a%84%e9%97%ae%e9%a2%98\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h3\u003e\u003cp\u003eä»Šå¤©å¸®æœ‹å‹çš„æœåŠ¡å™¨éƒ¨ç½²ä¸€ä¸ªå°ç¨‹åºå•†åŸæ—¶é‡åˆ°ä¸€ä¸ª session æ— æ³•ä¿å­˜çš„é—®é¢˜ã€‚\u003c/p\u003e","title":"PHP session è·å–ä¸åˆ°ä¹‹å‰è®¾ç½®å€¼çš„é—®é¢˜"},{"content":"å‚è€ƒ æŸ¥çœ‹æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰10ä¸ªIP #cat access.log | cut -d \u0026#39; \u0026#39; -f 1 | awk \u0026#39;{print $0}\u0026#39; | uniq -c | sort -nr | head -n 100 awkï¼šå¤ªå¼ºå¤§ï¼Œä¸€ä¸¤å¥è¯´ä¸æ¸…æ¥š uniq -c: æ•°æ®å»é‡ï¼Œ-c çš„æ„æ€æ˜¯è®¡æ•°ï¼ˆ\u0026ndash;countï¼‰ sort -nrï¼š æ’åºï¼Œ-n æŒ‰ç…§æ•°å­—æ’åº(\u0026ndash;numeric-sort)ï¼Œ-r å€’åºæ’åº(\u0026ndash;reverse) head -n 100ï¼š -n, \u0026ndash;lines=[-]K å½“å‰WEBæœåŠ¡å™¨ä¸­è”æ¥æ¬¡æ•°æœ€å¤šçš„ipåœ°å€ #netstat -ntu |awk \u0026#39;{print $5}\u0026#39; |sort | uniq -c| sort -nr æŸ¥çœ‹æ—¥å¿—ä¸­å‡ºç°100æ¬¡ä»¥ä¸Šçš„IPï¼Œå¹¶å€’åºæ˜¾ç¤º #cat access.log | cut -d \u0026#39; \u0026#39; -f 1 | awk \u0026#39;{print $0}\u0026#39; | uniq -c | sort -nr | awk \u0026#39;{if ($1 \u0026gt; 10) print $ ","date":"8 February 2017","permalink":"/linux-log-file-statistic-commands/","section":"Posts","summary":"\u003cp\u003e\u003ca href=\"http://xuqq999.blog.51cto.com/3357083/774714\" target=\"_blank\" rel=\"noreferrer\"\u003eå‚è€ƒ \u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"æŸ¥çœ‹æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰10ä¸ªip\" class=\"relative group\"\u003eæŸ¥çœ‹æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰10ä¸ªIP \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%e6%9f%a5%e7%9c%8b%e6%97%a5%e5%bf%97%e4%b8%ad%e8%ae%bf%e9%97%ae%e6%ac%a1%e6%95%b0%e6%9c%80%e5%a4%9a%e7%9a%84%e5%89%8d10%e4%b8%aaip\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h4\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecat access.log | cut -d \u0026#39; \u0026#39; -f 1 | awk \u0026#39;{print $0}\u0026#39; | uniq -c | sort -nr | head -n 100\n\u003c/code\u003e\u003c/pre\u003e","title":"Linux æ—¥å¿—åˆ†æå‘½ä»¤å¤‡å¿˜"},{"content":"","date":null,"permalink":"/tags/mysql/","section":"Tags","summary":"","title":"MySQL"},{"content":"è¿‘æœŸå…¬å¸æœ‰ä¸ªä¸šåŠ¡æ•°æ®é‡å·²ç»å¾ˆå¤§äº†ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºã€‚æœ¬æ–‡åšä¸ªå°çºªå½•\nMySQL åˆ†åŒºåŠŸèƒ½ç®€ä»‹ #åœ¨ MySQL 5.1 ä¹‹å‰ï¼Œå½“ä¸€å¼ è¡¨æ•°æ®è¿‡å¤šæ—¶ï¼Œæ•°æ®è¡¨çš„æ–‡ä»¶è¿‡å¤§ï¼Œä¸¥é‡å½±å“åˆ°æŸ¥è¯¢é€Ÿåº¦æ—¶ï¼Œç¨‹åºå‘˜ä»¬ä¼šå°†ä¸€å¼ å¤§è¡¨æ ¹æ®ä¸šåŠ¡é€»è¾‘æ¨ªå‘åˆ†å‰²ä¸ºå¤šå¼ è¡¨æ¥è¾¾åˆ°æ•°æ®åœ¨ç¡¬ç›˜åˆ†å¼€å­˜æ”¾çš„ç›®çš„ã€‚\nMySQL 5.1 åæ”¯æŒçš„åˆ†åŒºåŠŸèƒ½å¯ä»¥ç®—æ˜¯ MySQL å®˜æ–¹ã€Œåˆ†è¡¨ã€çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚å®ƒçš„ä¸»è¦ä¼˜ç‚¹æ˜¯ä¸šåŠ¡ä»£ç æ”¹åŠ¨æå°ã€‚\nåˆ¤æ–­ MySQL æ˜¯å¦å¼€å¯äº†åˆ†åŒºåŠŸèƒ½å¯ä»¥ä½¿ç”¨ show variables like \u0026quot;%part%\u0026quot;; å‘½ä»¤æŸ¥çœ‹ï¼š\nmysql\u0026gt; show variables like \u0026#34;%part%\u0026#34;; +-------------------+-------+ | Variable_name | Value | +-------------------+-------+ | have_partitioning | YES | +-------------------+-------+ 1 row in set (0.00 sec) InnoDB åˆ†åŒºé—®é¢˜ #Range åˆ†åŒºæ˜¯æœ€å¸¸è§çš„åˆ†åŒºæ–¹å¼\nCREATE TABLE `xxxxx` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `uid` int(11) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;ç”¨æˆ·Id\u0026#39;, `create_time` int(11) unsigned DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, PRIMARY KEY (`id`,`uid`), KEY `uid` (`uid`) ) ENGINE=InnoDB AUTO_INCREMENT=69210 DEFAULT CHARSET=utf8 COMMENT=\u0026#39;æ”¯æŒæ¯æ—¥èµ é€é²œèŠ±è¡¨\u0026#39; /*!50100 PARTITION BY RANGE (mod(uid,10)) (PARTITION sfg0 VALUES LESS THAN (1) ENGINE = InnoDB, PARTITION sfg1 VALUES LESS THAN (2) ENGINE = InnoDB, PARTITION sfg2 VALUES LESS THAN (3) ENGINE = InnoDB, PARTITION sfg3 VALUES LESS THAN (4) ENGINE = InnoDB, PARTITION sfg4 VALUES LESS THAN (5) ENGINE = InnoDB, PARTITION sfg5 VALUES LESS THAN (6) ENGINE = InnoDB, PARTITION sfg6 VALUES LESS THAN (7) ENGINE = InnoDB, PARTITION sfg7 VALUES LESS THAN (8) ENGINE = InnoDB, PARTITION sfg8 VALUES LESS THAN (9) ENGINE = InnoDB) */ æµ‹è¯•ç¯å¢ƒä½¿ç”¨ä»¥ä¸Š SQL å»ºè¡¨åï¼Œæ’å…¥æ•°æ®æµ‹è¯•æ—¶å‘ç°ï¼Œæ•°æ®åœ¨ç¡¬ç›˜ä¸Šçš„å¹¶ä¸æ˜¯æŒ‰ç…§åˆ†åŒºæ¥å­˜æ”¾çš„æ•°æ®æ–‡ä»¶çš„ï¼Œè¿˜æ˜¯å­˜äº†å•ä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯å°†æ•°æ®è¡¨å¼•æ“æ”¹ä¸º MyISAM åï¼Œæ˜¯å¯ä»¥æ­£å¸¸æŒ‰ç…§æ˜¯ä¸ªæ–‡ä»¶çš„åˆ†åŒºæ–¹å¼å­˜æ”¾æ•°æ®ã€‚è¿™åº”è¯¥å’Œä¸¤ç§å¼•æ“çš„æ•°æ®ç»“æ„æœ‰å…³ã€‚\næˆ‘æŸ¥çœ‹äº†æµ‹è¯•ç¯å¢ƒ MySQL çš„é…ç½®æ–‡ä»¶ innodb_file_per_table å­—æ®µå‘ç°ï¼Œæµ‹è¯•ç¯å¢ƒæ•°æ®åº“ InnoDB å¼•æ“ä½¿ç”¨çš„é»˜è®¤çš„å…±äº«è¡¨ç©ºé—´çš„é…ç½®ã€‚åŒä¸€ä¸ªæ•°æ®åº“ä¸‹æ‰€æœ‰è¡¨æ•°æ®éƒ½å­˜å‚¨åœ¨ data ç›®å½•ä¸‹ ibdata1 æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æ— æ³•å¯¹å®ƒè¿›è¡Œåˆ†åŒºã€‚ä¹…è€Œä¹…ä¹‹ ibdata1 è¿™ä¸ªæ–‡ä»¶ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¹Ÿä¸åˆ©äºæ•°æ®è¡¨ä¸­çš„æ•°æ®çš„è½¬ç§»å’Œå¤‡ä»½ã€‚\nä¿®æ”¹æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œåœ¨ my.cnf ä¸­ [mysqld] ä¸‹é…ç½®ï¼š\ninnodb_file_per_table=1 æ›´æ”¹é…ç½®ååˆ›å»ºä¸€ä¸ª åä¸ºtestçš„æ•°æ®åº“æµ‹è¯•åˆ†åŒºåçš„æ•°æ®æ˜¯å¦å­˜åœ¨äº†ä¸åŒçš„æ–‡ä»¶ä¸­ï¼Œå¦‚å›¾ï¼š\n10 ä¸ªåˆ†åŒºçš„æ•°æ®æ–‡ä»¶çš„å‘½åæ–¹å¼ä¸ºè¡¨å#åˆ†åŒºå.idbã€‚\né€šè¿‡æµ‹è¯•ç¯å¢ƒæµ‹è¯•ï¼Œæ²¡æœ‰æ”¹ä»»ä½•ä¸šåŠ¡ä»£ç ï¼Œæ•°æ®åº“æ€§èƒ½å¾—åˆ°äº†ä¸€å®šçš„æå‡ã€‚å¯è§ MySQL åˆ†åŒºæ˜¯ä¸ªä½æˆæœ¬çš„è§£å†³æ–¹æ¡ˆã€‚\n","date":"8 December 2016","permalink":"/mysql-fen-qu-yu-dao-de-xiao-wen-ti/","section":"Posts","summary":"\u003cp\u003eè¿‘æœŸå…¬å¸æœ‰ä¸ªä¸šåŠ¡æ•°æ®é‡å·²ç»å¾ˆå¤§äº†ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºã€‚æœ¬æ–‡åšä¸ªå°çºªå½•\u003c/p\u003e","title":"MySQL åˆ†åŒºé‡åˆ°çš„å°é—®é¢˜"},{"content":"ç»™å®šçš„ n ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 æ …æ çš„æµ·æ‹”åœ°å›¾çš„é«˜åº¦ï¼Œè®¡ç®—åœ¨ä¸‹é›¨ä¹‹åèƒ½å¤Ÿæ•è·å¤šå°‘æ°´ï¼Ÿ\né—®é¢˜è‹±æ–‡æè¿° #Given n non-negative integers representing an elevation map where the width of each bar is 1, compute how much water it is able to trap after raining.\nä¸¾ä¾‹ï¼š\nç»™å‡º [0,1,0,2,1,0,1,3,2,1,2,1], è¿”å› 6ã€‚\nè¿™ä¸ªé¢˜ç›®æœ‰ä¸ªæœ€å¥½ç†è§£çš„æ€è·¯ï¼Œå°±æ˜¯å…ˆæ‰¾åˆ°æœ€é«˜ç‚¹ï¼Œç„¶åå°†æ•´ä¸ª List åˆ†æˆä¸¤éƒ¨åˆ†å»è§£å†³ã€‚ æ‰¾åˆ°æœ€é«˜ç‚¹åï¼Œé‡‡å–ä»ä¸¤è¾¹ã€Œçˆ¬æ¥¼æ¢¯ã€çš„æ–¹å¼æ¥ç»Ÿè®¡å­˜æ°´çš„å¤šå°‘ï¼Œæ­£å¸¸çš„æ¥¼æ¢¯æ˜¯ä¸ä¼šå­˜æ°´çš„ï¼Œå› ä¸ºæ¥¼æ¢¯éƒ½æ˜¯èŠ‚èŠ‚é«˜çš„ã€‚ä»å·¦å³ä¸¤è¾¹å¼€å§‹çˆ¬ï¼Œçˆ¬æ¥¼çš„è¿‡ç¨‹ä¸­ç»´æŠ¤å½“å‰çˆ¬æ¥¼çš„ä¸´æ—¶æœ€é«˜å€¼ã€‚ä½äºè¿™ä¸ªä¸´æ—¶æœ€é«˜å€¼çš„ä¸€æ¥¼è‚¯å®šä¼šå­˜æ°´ï¼Œè¿™æ—¶å¾ˆå®¹æ˜“å°±èƒ½è®¡ç®—å‡ºå­˜æ°´é‡ã€‚\nç®—æ³•çš„æ—¶é—´å¤æ‚åº¦O(n)\nPython éƒ½å¿«å¿˜äº†ï¼Œé¡ºä¾¿ç»ƒä¹ ä¸€ä¸‹ã€‚ä¸‹é¢æ˜¯ Python å®ç°ï¼š\nclass Solution(object): def trap(self, height): \u0026#34;\u0026#34;\u0026#34; :type height: List[int] :rtype: int \u0026#34;\u0026#34;\u0026#34; # æ‰¾åˆ°æœ€å¤§å€¼ max_index = height.index(max(height)) height_len = len(height) # åˆå§‹åŒ–å·¦è¾¹å½“å‰æœ€å¤§å€¼ current_max = 0; # åˆå§‹åŒ–æ€»å­˜æ°´é‡ total = 0 # çˆ¬å·¦æ¥¼ for i in range(max_index): if height[i] \u0026gt; current_max: # ç»´æŠ¤å½“å‰æœ€å¤§å€¼ current_max = height[i] else: # ç´¯è®¡å­˜æ°´é‡ total += current_max - height[i] # åˆå§‹åŒ–å·¦è¾¹å½“å‰æœ€å¤§å€¼ current_max = height[height_len - 1]; # çˆ¬å³æ¥¼ for i in range(max_index, height_len)[::-1]: if height[i] \u0026gt; current_max: current_max = height[i] else: total += current_max - height[i] print total height_list = [0,1,0,2,1,0,1,3,2,1,2,1] solution = Solution() solution.trap(height_list) ","date":"23 February 2016","permalink":"/trapping-rain-water/","section":"Posts","summary":"\u003cp\u003eç»™å®šçš„ n ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¯ä¸ªå®½åº¦ä¸º 1 æ …æ çš„æµ·æ‹”åœ°å›¾çš„é«˜åº¦ï¼Œè®¡ç®—åœ¨ä¸‹é›¨ä¹‹åèƒ½å¤Ÿæ•è·å¤šå°‘æ°´ï¼Ÿ\u003c/p\u003e\n\u003cp\u003e\n\n\n\n\n\n\n  \n  \n\u003cfigure\u003e\u003cimg src=\"http://www.leetcode.com/static/images/problemset/rainwatertrap.png\" alt=\"ç¤ºä¾‹å›¾\" class=\"mx-auto my-0 rounded-md\" /\u003e\n\u003c/figure\u003e\n\u003c/p\u003e","title":"ã€LeetCodeã€‘42.Trapping Rain Water é—®é¢˜"},{"content":"","date":null,"permalink":"/tags/leetcode/","section":"Tags","summary":"","title":"LeetCode"},{"content":"æœ€è¿‘åœ¨å­¦ä¹ ä¸€äº›å¸¸ç”¨çš„ç»å…¸ç®—æ³•ï¼Œæ¯”è¾ƒç»å…¸çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ±‚è¿ç»­å­åˆ—çš„æœ€å¤§å’Œã€‚\nç”¨æ•°å­¦è¯­è¨€æè¿°å¦‚ä¸‹ï¼š\nç»™å®šåºåˆ—\n[-2,1,-3,4,-1,2,1,-5,4]\nè®¡ç®—å‡ºï¼š $$max([0,\u0026hellip;, \\sum A_k])$$\nLeetCode é“¾æ¥ Maximum Subarray\nè¿™ä¸ªé—®é¢˜ä½¿ç”¨åœ¨çº¿æœ€ä¼˜åŒ–æ±‚è§£(Online Optimization)ç®—æ³•æ˜¯æ•ˆç‡æœ€é«˜çš„,åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªå˜é‡ï¼Œä¸€æ¬¡å¾ªç¯å°±å¯ä»¥å®Œæˆã€‚\nclass Solution(object): def maxSubArray(self, nums): \u0026#34;\u0026#34;\u0026#34; :type nums: List[int] :rtype: int \u0026#34;\u0026#34;\u0026#34; max_sum = nums[0] current_sum = 0 for num in nums: current_sum += num if current_sum \u0026gt; max_sum: max_sum = current_sum if current_sum \u0026lt; 0: current_sum = 0; # ä¸å¯èƒ½ä½¿åé¢çš„å’Œå¢å¤§ï¼ŒæŠ›å¼ƒ return max_sum ä¸‹é¢æ˜¯è¿è¡Œç»“æœï¼š å¯è§è¿™æ˜¯æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒé«˜çš„è§£æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œä½†æ˜¯ LeetCode è¿˜æ¨èå»ç»ƒä¹ å¦ä¸€ç§åˆ†è€Œæ²»ä¹‹çš„è§£å†³åŠæ³•ï¼Œåº”è¯¥æ˜¯ç±»ä¼¼äºŒåˆ†æ³•ã€‚æœ‰æ—¶é—´å†å»å®ç°ä¸‹ã€‚\n","date":"14 February 2016","permalink":"/53-maximum-subarray/","section":"Posts","summary":"\u003cp\u003eæœ€è¿‘åœ¨å­¦ä¹ ä¸€äº›å¸¸ç”¨çš„ç»å…¸ç®—æ³•ï¼Œæ¯”è¾ƒç»å…¸çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ç»™å®šä¸€ä¸ªåºåˆ—ï¼Œæ±‚è¿ç»­å­åˆ—çš„æœ€å¤§å’Œã€‚\u003c/p\u003e\n\u003cp\u003eç”¨æ•°å­¦è¯­è¨€æè¿°å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cp\u003eç»™å®šåºåˆ—\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e[-2,1,-3,4,-1,2,1,-5,4]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eè®¡ç®—å‡ºï¼š $$max([0,\u0026hellip;, \\sum A_k])$$\u003c/p\u003e","title":"ã€LeetCodeã€‘æœ€å¤§å­åˆ—å’Œé—®é¢˜ï¼ˆ53 Maximum Subarrayï¼‰"},{"content":"é—®é¢˜æè¿° #å‘˜å·¥è¡¨åŒ…å«æ‰€æœ‰å‘˜å·¥ã€‚æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ä¸€ä¸ªIDï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€åˆ—è¡¨ç¤ºéƒ¨é—¨IDã€‚\néƒ¨é—¨è¡¨åŒ…æ‹¬å…¬å¸æ‰€æœ‰çš„éƒ¨é—¨ã€‚\nå†™ä¸€æ¡ SQL æŸ¥è¯¢å‡ºæ¯ä¸ªéƒ¨é—¨è–ªé…¬æ’åå‰ä¸‰çš„çš„å‘˜å·¥ã€‚å¯¹äºä¸Šè¿°è¡¨ï¼Œä½ çš„ SQL åº”è¯¥è¿”å›ä¸‹é¢å‡ åˆ—ã€‚\nLeetCodeé“¾æ¥ï¼šDepartment Top Three Salaries\nå‘˜å·¥è¡¨ #+----+-------+--------+--------------+ | Id | Name | Salary | DepartmentId | +----+-------+--------+--------------+ | 1 | Joe | 70000 | 1 | | 2 | Henry | 80000 | 2 | | 3 | Sam | 60000 | 2 | | 4 | Max | 90000 | 1 | | 5 | Janet | 69000 | 1 | | 6 | Randy | 85000 | 1 | +----+-------+--------+--------------+ éƒ¨é—¨è¡¨ #+----+----------+ | Id | Name | +----+----------+ | 1 | IT | | 2 | Sales | +----+----------+ å…³ç³»è¡¨ #+------------+----------+--------+ | Department | Employee | Salary | +------------+----------+--------+ | IT | Max | 90000 | | IT | Randy | 85000 | | IT | Joe | 70000 | | Sales | Henry | 80000 | | Sales | Sam | 60000 | +------------+----------+--------+ è§£å†³æ–¹æ¡ˆ #select d.Name Department, e.Name Employee, e.Salary from Employee e join Department d on d.Id=e.DepartmentId where ( select count(distinct Salary) from Employee where Salary \u0026gt; e.Salary and DepartmentId=d.id ) \u0026lt; 3 order by d.Name, e.Salary desc; ","date":"12 December 2015","permalink":"/leetcode-sql-tong-ji-bu-men-qian-san-ming-gong-zi-185-department-top-three-salaries/","section":"Posts","summary":"\u003ch3 id=\"é—®é¢˜æè¿°\" class=\"relative group\"\u003eé—®é¢˜æè¿° \u003cspan class=\"absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100\"\u003e\u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\" style=\"text-decoration-line: none !important;\" href=\"#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\u003c/span\u003e\u003c/h3\u003e\u003cp\u003eå‘˜å·¥è¡¨åŒ…å«æ‰€æœ‰å‘˜å·¥ã€‚æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ä¸€ä¸ªIDï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€åˆ—è¡¨ç¤ºéƒ¨é—¨IDã€‚\u003c/p\u003e\n\u003cp\u003eéƒ¨é—¨è¡¨åŒ…æ‹¬å…¬å¸æ‰€æœ‰çš„éƒ¨é—¨ã€‚\u003c/p\u003e\n\u003cp\u003eå†™ä¸€æ¡ SQL æŸ¥è¯¢å‡ºæ¯ä¸ªéƒ¨é—¨è–ªé…¬æ’åå‰ä¸‰çš„çš„å‘˜å·¥ã€‚å¯¹äºä¸Šè¿°è¡¨ï¼Œä½ çš„ SQL åº”è¯¥è¿”å›ä¸‹é¢å‡ åˆ—ã€‚\u003c/p\u003e\n\u003cp\u003eLeetCodeé“¾æ¥ï¼š\u003ca href=\"https://leetcode.com/problems/department-top-three-salaries/\" target=\"_blank\" rel=\"noreferrer\"\u003eDepartment Top Three Salaries\u003c/a\u003e\u003c/p\u003e","title":"ã€LeetCodeã€‘SQL ç»Ÿè®¡éƒ¨é—¨å‰ä¸‰åå·¥èµ„185. Department Top Three Salaries"},{"content":"æœ€è¿‘åœ¨å¤šä¸ªè™šæ‹Ÿæœºä¸Šåšä¸»ä»åˆ†ç¦»çš„å®éªŒï¼Œé‡åˆ°çš„å°é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚\nå¼€å¯ binlog æ—¥å¿— #ä¿®æ”¹ my.cnf å MySQL æ— æ³•å¯åŠ¨ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š\nlog-bin=mysql-bin åæ¥é€šè¿‡æœç´¢ç›¸å…³èµ„æ–™å‘ç° MySQL 5.7 ä»¥åå¼€å¯binlog æ—¥å¿—éœ€è¦é…ç½® server-idã€‚\nå‚è§ å®˜æ–¹æ–‡æ¡£ï¼š\nIn MySQL 5.7.2 and earlier, if you start a master server without using \u0026ndash;server-id to set its ID, the default ID is 0. In this case, the master refuses connections from all slaves, slaves refuse to connect to the master, and the server sets the server_id system variable to 1. In MySQL 5.7.3 and later, the \u0026ndash;server-id must be used if binary logging is enabled, and a value of 0 is not changed by the server. If you specify \u0026ndash;server-id without an argument, the effect is the same as using 0. In either case, if the server_id is 0, binary logging takes place, but slaves cannot connect to the master, nor can any other servers connect to it as slaves. (Bug #11763963, Bug #56718)\nSlave_IO_Running: Connecting é—®é¢˜ #ä¸»æœåŠ¡å™¨é…ç½®ï¼š\ngrant replication slave on *.* to \u0026#39;slave\u0026#39;@\u0026#39;192.168.206.191\u0026#39; identifie by \u0026#39;XXX\u0026#39;; mysql\u0026gt; show master status; +-------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +-------------------+----------+--------------+------------------+-------------------+ | master-bin.000003 | 882 | | | | +-------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.00 sec) ä»æœåŠ¡å™¨é…ç½®ï¼š\nchange master to master_host=\u0026#39;192.168.10.130\u0026#39;, master_user=\u0026#39;xxx\u0026#39;, master_password=\u0026#39;password\u0026#39;, master_log_file=\u0026#39;mysql-bin.000005\u0026#39;, master_log_pos=261; è¿è¡Œ show slave status å‘ç° Slave_IO_Running ä¸€æ æ˜¾ç¤º Connectingã€‚è¿™ç§é—®é¢˜ä¸€èˆ¬è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š\nmasterã€slave ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œå°¤å…¶æ³¨æ„ master_log_fileã€master_log_pos\nç½‘ç»œã€é˜²ç«å¢™ã€selinux é—®é¢˜\nmasterã€slave æœåŠ¡å™¨ server-id éœ€è¦ä¸ä¸€è‡´\nMySQL çš„ server UUID #è¿™ä¸ªé—®é¢˜æ¯”è¾ƒå°‘è§ï¼Œå¤šè§äºä¸»ä»æœåŠ¡å™¨ä½¿ç”¨çš„åŒä¸€ä¸ªç³»ç»Ÿå¿«ç…§æ—¶ã€‚\nshow slave status ä¼šæç¤ºæŠ¥é”™ä¿¡æ¯ï¼š\nLast_IO_Error: Fatal error: The slave I/O thread stops because master and slave have equal MySQL server UUIDs; these UUIDs must be different for replication to work.\nMySQL çš„ datadir ä¸‹ æœ‰ä¸ªauto.cnf æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è®°å½•äº† MySQL æœåŠ¡å™¨çš„UUIDã€‚\nMySQL çš„ data ç›®å½•å¯ä»¥ä½¿ç”¨ show variables like \u0026quot;%dir%\u0026quot;; æŸ¥çœ‹ã€‚\nMySQL çš„å¯ä»¥æŠŠå…¶ä¸­ä¸€å°æœåŠ¡å™¨çš„auto.cnf åˆ é™¤ï¼Œé‡å¯ MySQL æœåŠ¡å™¨åä¼šå†æ¬¡ç”Ÿæˆæ–°çš„ä¸é‡å¤çš„ UUID æ–‡ä»¶ã€‚\n","date":"18 November 2015","permalink":"/mysql-zhu-cong-fen-chi-pei-zhi-de-yi-xie-keng/","section":"Posts","summary":"\u003cp\u003eæœ€è¿‘åœ¨å¤šä¸ªè™šæ‹Ÿæœºä¸Šåšä¸»ä»åˆ†ç¦»çš„å®éªŒï¼Œé‡åˆ°çš„å°é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚\u003c/p\u003e","title":"MySQL ä¸»ä»åˆ†ç¦»é…ç½®çš„ä¸€äº›å‘"},{"content":"ä»Šå¤©å®‰è£…äº†ä¸€å° Centos 6.8 minimal åšæµ‹è¯•ä½¿ç”¨ï¼Œå®‰è£…åï¼Œé»˜è®¤ç½‘å¡æ˜¯æ²¡æœ‰å¼€æœºå¯åŠ¨çš„ã€‚ä½¿ç”¨çš„æ˜¯æ¡¥æ¥æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯é€šè¿‡å®¿ä¸»æœºçš„è™šæ‹Ÿè·¯ç”±å™¨å°†å®¿ä¸»æœºå’Œè™šæ‹Ÿæœºè¿æ¥åˆ°ä¸€èµ·ã€‚\né¦–å…ˆæ”¹ä¸‹é…ç½® eth-0 çš„é…ç½®\nvi /etc/sysconfig/network-scripts/ifcfg-eth0ï¼š\n... ONBOOT=yes ... æ‰‹åŠ¨é‡å¯ç½‘ç»œ services network restart\nç°åœ¨è¿˜æ˜¯ ping ä¸åŒå¤–ç½‘ï¼Œè¿˜éœ€è¦æ”¹ä¸€ä¸‹ DNS çš„é…ç½®ï¼š\nvi /etc/resolv.conf\n... nameserver 8.8.8.8 # æˆ–è€… 114.114.114.114 ä¿å­˜ååœ¨é‡å¯ä¸‹ç½‘ç»œï¼Œç°åœ¨å‘ç°å¯ä»¥ PING é€šå¤–ç½‘äº†ã€‚\nå¦‚æœéœ€è¦æ‰‹åŠ¨é…ç½®é™æ€IPã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š\n... BOOTPROTO=\u0026#34;static\u0026#34; IPADDR=192.168.0.103 NETMASK=255.255.255.0 GATEWAY=192.168.0.1 BROADCAST=192.168.0.255 DNS1=114.114.114.114 ä¿®æ”¹é…ç½®åé‡å¯åç”Ÿæ•ˆã€‚\nå¦‚æœéœ€è¦ä½¿ç”¨ ssh ç™»å½•ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦ç¦ç”¨ä¸‹ IPV6ï¼Œå¦åˆ™å¯èƒ½å‡ºç° ssh æ— æ³•è¿æ¥çš„æƒ…å†µã€‚\n","date":"8 October 2015","permalink":"/virtualbox-centos-minimal-network-config-and-ssh-login/","section":"Posts","summary":"\u003cp\u003eä»Šå¤©å®‰è£…äº†ä¸€å° Centos 6.8 minimal åšæµ‹è¯•ä½¿ç”¨ï¼Œå®‰è£…åï¼Œé»˜è®¤ç½‘å¡æ˜¯æ²¡æœ‰å¼€æœºå¯åŠ¨çš„ã€‚ä½¿ç”¨çš„æ˜¯æ¡¥æ¥æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯é€šè¿‡å®¿ä¸»æœºçš„è™šæ‹Ÿè·¯ç”±å™¨å°†å®¿ä¸»æœºå’Œè™šæ‹Ÿæœºè¿æ¥åˆ°ä¸€èµ·ã€‚\u003c/p\u003e","title":"VirtualBox CentOSï¼ˆminimalï¼‰é…ç½®ç½‘ç»œè®¿é—®å¤–ç½‘æ”¯æŒå¹¶ SSH"},{"content":"å‰å‡ å¤©ä¹°äº†ä¸ª VPSï¼Œå› ä¸ºä¹‹å‰æ¥è§¦ Nginx ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥æŠ˜è…¾ LNMPç¯å¢ƒæŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ï¼Œæ‰€ä»¥æˆ‘æƒ³é‡æ–°å®‰è£…ä¸€éå¹¶å†™ç¯‡å­¦ä¹ ç¬”è®°ï¼Œæˆ–è€…è¯´æ•™ç¨‹ï¼Œå› æ­¤æœ¬æ–‡å°†ä»åœ¨å´­æ–°çš„ Centos ä¸Šæ­å»º LNMP ç¯å¢ƒï¼Œä¸ºäº†æ‰€æœ‰è½¯ä»¶éƒ½å¯ä»¥é€‰æ‹©æŒ‡å®šç‰ˆæœ¬å’Œå®‰è£…é…ç½®ï¼Œå› æ­¤é™¤äº†ä¾èµ–åŒ…ä¹‹å¤–éƒ½é‡‡ç”¨æºç åŒ…å®‰è£…çš„æ–¹å¼æ¥å®‰è£…ã€‚åºŸè¯ä¸å¤šè¯´ï¼ŒåˆšåˆšæŠŠ VPS rebulidã€‚\næ³¨ï¼šæœ¬æ–‡å±äºæ–°æ‰‹å‹å¥½å‹ï¼Œèƒ½é‡åˆ°çš„é”™è¯¯åŸºæœ¬ä¸Šéƒ½ä¼šé‡åˆ°ã€‚ğŸ˜„\nä¸€ã€å®‰è£… Nginx #è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯1.8.0 æ‰§è¡Œå‘½ä»¤ä¸‹è½½å¹¶è§£å‹ Nginx æºç åŒ…\nwget http://nginx.org/download/nginx-1.8.0.tar.gz tar -xzvf nginx-1.8.0.tar.gz cd nginx-1.8.0 è¿™é‡Œæˆ‘ä»¬./Configure è‚¯å®šä¼šæŠ¥é”™çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿™æ˜¯ä¸€å°å´­æ–°çš„ Centos ç³»ç»Ÿï¼Œç¼ºå°‘å¥½å¤šNginxä¾èµ–åŒ…ï¼Œè¿™é‡Œæˆ‘ç›´æ¥ ./configure å…ˆè¯•ä¸€ä¸‹æœ‰ä»€ä¹ˆé”™è¯¯\n./configure: error: C compiler cc is not found\nå¥½å§ï¼Œç”šè‡³è¿ gcc éƒ½æ²¡æœ‰ï¼Œå…ˆå®‰è£… gcc æ‰èƒ½ç¼–è¯‘æºç \nyum install gcc ä¸‹é¢æ­£å¼ç¼–è¯‘\n./configure --prefix=/usr --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx/nginx.pid --lock-path=/var/lock/nginx.lock --user=nginx --group=nginx --with-http_ssl_module --with-http_flv_module --with-http_stub_status_module --with-http_gzip_static_module --http-client-body-temp-path=/var/tmp/nginx/client/ --http-proxy-temp-path=/var/tmp/nginx/proxy/ --http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ --http-uwsgi-temp-path=/var/tmp/nginx/uwsgi --http-scgi-temp-path=/var/tmp/nginx/scgi --with-pcre åˆä¸€ä¸ªé”™è¯¯æ¥äº†\n./configure: error: the HTTP rewrite module requires the PCRE library. You can either disable the module by using \u0026ndash;without-http_rewrite_module option, or install the PCRE library into the system, or build the PCRE library statically from the source with nginx by using \u0026ndash;with-pcre= option.\nè¿™ä¸ªé”™è¯¯æˆ‘ä»¬çœ‹æç¤ºå¯ä»¥çœ‹å‡ºï¼ŒNginx éœ€è¦å®‰è£… PCRE Libraryï¼Œç±»ä¼¼çš„é”™è¯¯æç¤ºè¿˜æœ‰å¾ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬ä¸€æ¬¡æ€§å°† Nginx çš„ä¾èµ–åŒ…éƒ½å®‰è£…ä¸Š\n//å®‰è£…PCRE åº“æ˜¯ä¸ºä½¿ç”¨ Nginx æ”¯æŒ HTTP Rewrite æ¨¡å—ã€‚ yum -y install pcre-devel // zlib yum -y install zlib-devel // openssl yum -y install openssl-devel å†æ‰§è¡Œä¸Šé¢çš„ ./configure å‘½ä»¤ï¼Œå½“å‡ºç°ä¸‹é¢æç¤ºæ—¶ï¼Œè¯´æ˜æˆ‘ä»¬å·²ç»é…ç½®å¥½äº†å¯ä»¥ç¼–è¯‘äº† å› ä¸ºæˆ‘ä»¬é…ç½®æ—¶å®šä¹‰äº† user å’Œ groupï¼Œä¸‹é¢æ–°å»ºä¸€ä¸ªnginx ç”¨æˆ·å’Œnginx ç”¨æˆ·ç»„æ‰èƒ½è¿è¡ŒnginxæœåŠ¡è¿›ç¨‹\n# groupadd -r nginx # useradd -r -g nginx -s /bin/false -M nginx # id nginx Configuration summary\nusing system PCRE library using system OpenSSL library md5: using OpenSSL library sha1: using OpenSSL library using system zlib library \u0026hellip;\u0026hellip; make //ä¸€èˆ¬ make test å¯çœç•¥ make test make install å®‰è£…æˆåŠŸåæˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›é…ç½®\n1ã€ä¸ºNginxæä¾›sysvé£æ ¼çš„æœåŠ¡è„šæœ¬ï¼ˆ Red Hat Nginx Init Script Should work on RHEL, Fedora, CentOS. Tested on CentOS 5. Save this file as /etc/init.d/nginx ï¼‰\nåœ¨æ–°å»ºæ–‡ä»¶\nvi /etc/rc.d/init.d/nginx å†…å®¹å¦‚ä¸‹ï¼š\n#!/bin/sh # # nginx - this script starts and stops the nginx daemon # # chkconfig: - 85 15 # description: Nginx is an HTTP(S) server, HTTP(S) reverse \\ # proxy and IMAP/POP3 proxy server # processname: nginx # config: /etc/nginx/nginx.conf # config: /etc/sysconfig/nginx # pidfile: /var/run/nginx.pid # Source function library. . /etc/rc.d/init.d/functions # Source networking configuration. . /etc/sysconfig/network # Check that networking is up. [ \u0026#34;$NETWORKING\u0026#34; = \u0026#34;no\u0026#34; ] \u0026amp;\u0026amp; exit 0 nginx=\u0026#34;/usr/sbin/nginx\u0026#34; prog=$(basename $nginx) NGINX_CONF_FILE=\u0026#34;/etc/nginx/nginx.conf\u0026#34; [ -f /etc/sysconfig/nginx ] \u0026amp;\u0026amp; . /etc/sysconfig/nginx lockfile=/var/lock/subsys/nginx make_dirs() { # make required directories user=`nginx -V 2\u0026gt;\u0026amp;1 | grep \u0026#34;configure arguments:\u0026#34; | sed \u0026#39;s/[^*]*--user=\\([^ ]*\\).*/\\1/g\u0026#39; -` options=`$nginx -V 2\u0026gt;\u0026amp;1 | grep \u0026#39;configure arguments:\u0026#39;` for opt in $options; do if [ `echo $opt | grep \u0026#39;.*-temp-path\u0026#39;` ]; then value=`echo $opt | cut -d \u0026#34;=\u0026#34; -f 2` if [ ! -d \u0026#34;$value\u0026#34; ]; then # echo \u0026#34;creating\u0026#34; $value mkdir -p $value \u0026amp;\u0026amp; chown -R $user $value fi fi done } start() { [ -x $nginx ] || exit 5 [ -f $NGINX_CONF_FILE ] || exit 6 make_dirs echo -n $\u0026#34;Starting $prog: \u0026#34; daemon $nginx -c $NGINX_CONF_FILE retval=$? echo [ $retval -eq 0 ] \u0026amp;\u0026amp; touch $lockfile return $retval } stop() { echo -n $\u0026#34;Stopping $prog: \u0026#34; killproc $prog -QUIT retval=$? echo [ $retval -eq 0 ] \u0026amp;\u0026amp; rm -f $lockfile return $retval } restart() { configtest || return $? stop sleep 1 start } reload() { configtest || return $? echo -n $\u0026#34;Reloading $prog: \u0026#34; killproc $nginx -HUP RETVAL=$? echo } force_reload() { restart } configtest() { $nginx -t -c $NGINX_CONF_FILE } rh_status() { status $prog } rh_status_q() { rh_status \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 } case \u0026#34;$1\u0026#34; in start) rh_status_q \u0026amp;\u0026amp; exit 0 $1 ;; stop) rh_status_q || exit 0 $1 ;; restart|configtest) $1 ;; reload) rh_status_q || exit 7 $1 ;; force-reload) force_reload ;; status) rh_status ;; condrestart|try-restart) rh_status_q || exit 0 ;; *) echo $\u0026#34;Usage: $0 {start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest}\u0026#34; exit 2 esac ç»™äºˆåˆšæ‰çš„æ–‡ä»¶å¯æ‰§è¡Œæƒé™\nchmod +x /etc/rc.d/init.d/nginx å¹¶æŠŠä»–æ·»åŠ åˆ°æœåŠ¡åˆ—è¡¨ä¸­\nchkconfig --add nginx chkconfig nginx on å¯åŠ¨æœåŠ¡ï¼Œå¹¶æŸ¥çœ‹å¯åŠ¨çŠ¶æ€\n/etc/init.d/nginx start netstat -tnlp | grep nginx ç°åœ¨åœ¨å¯ä»¥è®¿é—®äº†ï¼ŒWelcome to nginx!\né‡å¯æœåŠ¡å‘½ä»¤\n/etc/init.d/nginx restart /etc/init.d/nginx stop äºŒã€å®‰è£… MySQL #ä¸‹è½½ MySQL #MySQL çš„å®˜æ–¹ä¸‹è½½åœ°å€ï¼Œè¿›å»é€‰æ‹© Source Code è¿™é‡Œæˆ‘è£…çš„æ˜¯5.6.28 å¦‚æœä½ ä¸æƒ³å†å»å®˜ç½‘æ‰¾çš„è¯ï¼Œå¯ä»¥åœ¨ä½ çš„ä¸‹è½½ç›®å½•ç›´æ¥æ‰§è¡Œ\nwget http://cdn.mysql.com//Downloads/MySQL-5.6/mysql-5.6.28.tar.gz tar -xzvf mysql-5.6.28.tar.gz cd mysql-5.6.28 å‡†å¤‡å·¥ä½œ #å®‰è£…å‰çš„å‡†å¤‡å·¥ä½œï¼ŒMySQLéœ€è¦ç”¨åˆ°çš„ä¾èµ–åŒ…ä¾æ¬¡å®‰è£…ä¸Š\nyum -y install gcc-c++ yum -y install cmake yum -y install bison-devel yum -y install ncurses-devel ç¼–è¯‘å®‰è£… #ç¼–è¯‘é…ç½®\ncmake \\ -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\ -DMYSQL_DATADIR=/usr/local/mysql/data \\ -DSYSCONFDIR=/etc \\ -DWITH_MYISAM_STORAGE_ENGINE=1 \\ -DWITH_INNOBASE_STORAGE_ENGINE=1 \\ -DWITH_MEMORY_STORAGE_ENGINE=1 \\ -DWITH_READLINE=1 \\ -DMYSQL_UNIX_ADDR=/var/lib/mysql/mysql.sock \\ -DMYSQL_TCP_PORT=3306 \\ -DENABLED_LOCAL_INFILE=1 \\ -DWITH_PARTITION_STORAGE_ENGINE=1 \\ -DEXTRA_CHARSETS=all \\ -DDEFAULT_CHARSET=utf8 \\ -DDEFAULT_COLLATION=utf8_general_ci å‚æ•°è¯¦ç»†é…ç½®ï¼Œå‚è€ƒMySQLå®˜æ–¹æ–‡æ¡£çš„MySQL Source-Configuration Options æˆ‘è¿™é‡Œå‡ºç°äº†ä»¥ä¸‹è­¦å‘Šï¼š\nCMake Warning: Manually-specified variables were not used by the project:\nWITH_MEMORY_STORAGE_ENGINE\nWITH_READLINE\n\u0026ndash; Build files have been written to: /root/lnmp_source/mysql-5.6.28\næç¤ºä¸¤ä¸ªé…ç½®é¡¹æ²¡æœ‰åº”ç”¨ä¸Šï¼Œæˆ‘å¹²è„†å°±æŠŠè¿™ä¸¤é¡¹é…ç½®å»æ‰äº†é‡æ–°./configure äº†ä¸€ä¸‹ï¼Œè¿™æ¬¡æ²¡æœ‰è­¦å‘Šäº† æˆ‘æŸ¥äº†ä¸‹è¿™ä¸¤é¡¹çš„ä½œç”¨ï¼š\n-WITH_MEMORY_STORAGE_ENGINE #æ”¯æŒMemoryå¼•æ“ -DWITH_READLINE=1 \\ #å¿«æ·é”®åŠŸèƒ½\nå¦‚æœç”¨åˆ°å†åšé…ç½®ï¼Œä¸‹é¢å®‰è£…\nå¥½äº†å¼€å§‹ç¼–è¯‘\nmake MySQL ç¼–è¯‘æ—¶é—´æ¯”è¾ƒé•¿\u0026hellip;æˆ‘è¿™å•æ ¸ VPS\u0026hellip;30åˆ†é’Ÿå\u0026hellip;\nmake install åˆ›å»º MySQL çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„\ngroupadd mysql useradd -g mysql mysql ä¿®æ”¹/usr/local/mysqlæƒé™\nchown -R mysql:mysql /usr/local/mysql åˆå§‹åŒ–é…ç½® #è¿›å…¥å®‰è£…è·¯å¾„\ncd /usr/local/mysql è¿›å…¥å®‰è£…è·¯å¾„ï¼Œæ‰§è¡Œåˆå§‹åŒ–é…ç½®è„šæœ¬ï¼Œåˆ›å»ºç³»ç»Ÿè‡ªå¸¦çš„æ•°æ®åº“å’Œè¡¨\nscripts/mysql_install_db --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --user=mysql è¿™é‡Œæ‰§è¡Œä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š\n./scripts/mysql_install_db: /usr/bin/perl: bad interpreter: No such file or directory åŸå› æ˜¯ç³»ç»Ÿæ²¡æœ‰å®‰è£…Perl å’Œ Perl-devel\nè§£å†³åŠæ³•ï¼Œæ‰§è¡Œï¼š\nyum -y install perl perl-devel å®‰è£…å®Œæˆåå†æ‰§è¡Œ MySQL åˆå§‹åŒ–è„šæœ¬å°±å¯ä»¥äº† ç°åœ¨åº”è¯¥å¯ä»¥å¼€å¯ MySQL äº†ã€‚\nåŒæ ·å°† MySQL æä¾›çš„sysvé£æ ¼çš„æœåŠ¡è„šæœ¬å¤åˆ¶åˆ° /etc/init.d/mysqlç›®å½•\ncp support-files/mysql.server /etc/init.d/mysql // è®¾ç½®å¼€æœºå¯åŠ¨ chkconfig mysql on // å¯åŠ¨æœåŠ¡ service mysql start // å¯åŠ¨MySQL // æˆ–è€…ä½¿ç”¨ /etc/init.d/mysql start // å¯åŠ¨ MySQL å°† MySQL åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œä¿®æ”¹/etc/profileæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ \nPATH=/usr/local/mysql/bin:$PATH export PATH ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤è®©é…ç½®ç”Ÿæ•ˆ\nsource /etc/profile MySQL è·‘èµ·æ¥äº†ï¼Œæˆ‘æä½é… 512 å†…å­˜çš„ VPS ç¬é—´è¢«å ç”¨äº† 400MB å•Š ä¿®æ”¹ /usr/local/mysql/my.cnf ä¸­çš„ä»¥ä¸‹å‡ é¡¹é…ç½®ï¼ˆæ²¡æœ‰è¯¥é¡¹å¯ä»¥æ·»åŠ ï¼‰ï¼š\ntable_definition_cache=400 table_open_cache=256 ç„¶å\n/etc/init.d/mysql restart ç¬é—´æ¸…çˆ½äº†ï¼Œåªèƒ½ç‰ºç‰²æ€§èƒ½äº†ğŸ˜‚ã€‚\nä¿®æ”¹ MySQL root è´¦æˆ·å¯†ç  #mysql -uroot mysql\u0026gt; SET PASSWORD = PASSWORD(\u0026#39;YOUR PASSWORD\u0026#39;); ä¿®æ”¹é˜²ç«å¢™é…ç½® #æ‰“å¼€/etc/sysconfig/iptables\nåœ¨â€œ-A INPUT â€“m state \u0026ndash;state NEW â€“m tcp â€“p â€“dport 22 â€“j ACCEPTâ€ï¼Œä¸‹æ·»åŠ ï¼š\n-A INPUT -m state --state NEW -m tcp -p -dport 3306 -j ACCEPT ç„¶åä¿å­˜ï¼Œå¹¶å…³é—­è¯¥æ–‡ä»¶ï¼Œåœ¨ç»ˆç«¯å†…è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ·æ–°é˜²ç«å¢™é…ç½®ï¼š\nservice iptables restart MySQL å®‰è£…å®Œæ¯•ã€‚\nå®‰è£… PHP7 #ä¸‹è½½ PHP7æºç åŒ… #æˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯ PHP 7ï¼Œä¸‹è½½åˆ«çš„ç‰ˆæœ¬å»php.net\nwget http://cn2.php.net/distributions/php-7.0.2.tar.gz tar -xzvf php-7.0.2.tar.gz cd php-7.0.2 ç¼–è¯‘é…ç½® #å¦‚æœæˆ‘ä»¬ç›´æ¥é…ç½®çš„è¯åº”è¯¥ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ä¸€äº› PHP çš„ä¾èµ–åŒ…ï¼Œç¼–è¯‘é…ç½®ä¸€ä¸‹è¯•è¯•\n./configure --enable-fpm --with-mysql é¦–å…ˆæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š\nconfigure: error: xml2-config not found. Please check your libxml2 installation.\nç¼ºå°‘ libxml2ï¼Œç›´æ¥ä½¿ç”¨ yum æ–¹å¼å®‰è£… libxml2\nyum install -y libxml2 ä¸‹é¢ä¸€å£æ°”æŠŠæ‰€æœ‰çš„PHP ç”¨åˆ°çš„è½¯ä»¶åŒ…éƒ½å®‰è£…ä¸Š\nyum install -y libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers php-mysqlnd libmcrypt-devel libtidy libtidy-devel recode recode-devel libxpm-devel å®‰è£…å®Œä¹‹åå¯ä»¥ç¼–è¯‘é…ç½®äº†\n./configure --prefix=/usr/local/php7 --with-config-file-path=/etc/php7 --with-mysql=mysqlnd --with-pdo-mysql=mysqlnd --with-mysqli=mysqlnd --with-gd --with-iconv --with-zlib --enable-xml --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-fpm --enable-mbstring --enable-ftp --enable-gd-native-ttf --with-openssl --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --without-pear --with-gettext --enable-session --with-mcrypt --with-curl --with-jpeg-dir --with-freetype-dir --with-xpm-dir=/usr --with-bz2 æ³¨æ„å‰ä¸¤ä¸ªé…ç½®\n--prefix=/usr/local/php7 //å®‰è£…ä½ç½® --with-config-file-path=/etc/php7 //é…ç½®æ–‡ä»¶ä½ç½® å¦‚æœè¿˜ä¼šæŠ¥é”™ï¼Œå¯èƒ½æ˜¯ç¼ºå°‘ä¾èµ–åŒ…ï¼ŒæŒ‰ç…§æç¤ºå®‰è£…å°±å¯ä»¥äº†ã€‚\nconfigure: error: xpm.h not found.\nä¸Šé¢å¿˜äº†å®‰è£… libxpm å’Œ mcrypt æ‰©å±• å®‰è£… libXpm\nyum install libXpm-devel å¥½å¤š yum æºä¸­æ²¡æœ‰ mcryptï¼Œæ‹…å¿ƒç¬¬ä¸‰æ–¹æºä¸å¯é ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨æºç å®‰è£… mcryptï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªç›®å½•\nwget ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/libmcrypt-2.5.6.tar.gz tar -zxvf libmcrypt-2.5.6.tar.gz cd libmcrypt-2.5.6.tar. make \u0026amp;\u0026amp; make install å†é…ç½®ï¼Œç¼–è¯‘å®‰è£…\nmake sudo make install è¿™é‡Œåˆ—å‡º PHP ç¼–è¯‘é…ç½®å¸¸è§é”™è¯¯å’Œè§£å†³åŠæ³•ï¼š\nconfigure: error: xslt-config not found. Please reinstall the libxslt \u0026gt;= 1.1.0 distribution\nyum install libxslt-devel configure: error: Could not find net-snmp-config binary. Please check your net-snmp installation.\nyum install net-snmp-devel configure: error: Please reinstall readline - I cannot find readline.h\nyum install readline-devel configure: error: Cannot find pspell\nyum install aspell-devel checking for unixODBC support\u0026hellip; configure: error: ODBC header file \u0026lsquo;/usr/include/sqlext.h\u0026rsquo; not found!\nyum install unixODBC-devel configure: error: Unable to detect ICU prefix or /usr/bin/icu-config failed. Please verify ICU install prefix and make sure icu-config works.\nyum install libicu-devel configure: error: utf8mime2text() has new signature, but U8TCANONICAL is missing. This should not happen. Check config.log for additional information.\nyum install libc-client-devel configure: error: freetype.h not found.\nyum install freetype-devel configure: error: xpm.h not found.\nyum install libXpm-devel configure: error: png.h not found.\nyum install libpng-devel configure: error: vpx_codec.h not found.\nyum install libvpx-devel configure: error: Cannot find enchant\nyum install enchant-devel configure: error: Please reinstall the libcurl distribution - easy.h should be in /include/curl/\né…ç½® Nginx #nginxæœ¬èº«ä¸èƒ½å¤„ç†PHPï¼Œå®ƒåªæ˜¯ä¸ªwebæœåŠ¡å™¨ï¼Œå½“æ¥æ”¶åˆ°è¯·æ±‚åï¼Œå¦‚æœæ˜¯phpè¯·æ±‚ï¼Œåˆ™å‘ç»™phpè§£é‡Šå™¨å¤„ç†ï¼Œå¹¶æŠŠç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚\nnginxä¸€èˆ¬æ˜¯æŠŠè¯·æ±‚å‘fastcgiç®¡ç†è¿›ç¨‹å¤„ç†ï¼Œfascgiç®¡ç†è¿›ç¨‹é€‰æ‹©cgiå­è¿›ç¨‹å¤„ç†ç»“æœå¹¶è¿”å›è¢«nginx\né¦–å…ˆä¿®æ”¹ Nginx çš„é…ç½®ï¼Œåˆšæ‰å®‰è£…æ—¶é…ç½®çš„é…ç½®æ–‡ä»¶ç›®å½•æ˜¯ /etc/nginx/nginx.conf\nvi /etc/nginx/nginx.conf # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # location ~ .php$ { root /var/www; //æ ¹ç›®å½• root\tfastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } è¿™é‡Œéœ€è¦æ³¨æ„ location ~.php çš„é…ç½®å—çš„ root æ ¹ç›®å½•ä¸€å®šè¦è·Ÿ server å—çš„é…ç½®ä¸€æ ·ï¼Œå¦åˆ™ php æ–‡ä»¶ä¼šä¸èƒ½è§£æï¼Œä¼šæŠ¥ File not found é”™è¯¯ã€‚\nåŒæ—¶ä¹Ÿå»ºè®®åœ¨location / é…ç½®ä¸‹çš„ index åŠ ä¸Š index.php\né…ç½®å¥½ Nginx å¯ä»¥å…ˆå°è¯•å¯åŠ¨ php-fpm\n/usr/local/php7/sbin/php-fpm å—¯ï¼Œæ˜¯çš„ï¼Œåº”è¯¥ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ğŸ˜„\nERROR: failed to open configuration file \u0026lsquo;/local/php7/etc/php-fpm.conf\u0026rsquo;: No such file or directory (2) [20-Jan-2016 10:56:50] ERROR: failed to load configuration file \u0026lsquo;/local/php7/etc/php-fpm.conf\u0026rsquo;\nå°†é»˜è®¤çš„é…ç½®æ–‡ä»¶ cp ä¸ºæ­£æˆ¿\ncp /local/php7/etc/php-fpm.conf.default /local/php7/etc/php-fpm.conf å¦‚æœè¿™æ—¶å€™å¯åŠ¨ php-fpm ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯\nWARNING: Nothing matches the include pattern \u0026lsquo;/local/php7/etc/php-fpm.d/*.conf\u0026rsquo; from /local/php7/etc/php-fpm.conf at line 125. [20-Jan-2016 11:03:40] ERROR: No pool defined. at least one pool section must be specified in config file\næ ¹æ®é”™è¯¯æç¤ºä¿¡æ¯ï¼Œè¿˜æ˜¯åˆå§‹åŒ–é…ç½®æ–‡ä»¶\ncp /local/php7/etc/php-fpm.d/www.conf.default /local/php7/etc/php-fpm.d/www.conf è¿™æ—¶å€™åº”è¯¥å¯ä»¥å¯åŠ¨äº†ã€‚ ä¸‹é¢æµ‹è¯•ä¸€ä¸‹\ncd /var/www echo \u0026#34;\u0026lt;?php phpinfo();\u0026#34; \u0026gt; index.php åˆ°æ­¤ä¸ºæ­¢ï¼Œæ•´ä¸ªå®‰è£…è¿‡ç¨‹å°±å†™å®Œäº†.\né›¶é›¶æ•£æ•£åœ°çœ‹äº†ç½‘ä¸Šå¾ˆå¤šçš„æ•™ç¨‹ï¼Œæ‰€ä»¥å†³å®šæ€»ï¼ˆfuï¼‰ç»“ï¼ˆzhiï¼‰ä¸€ï¼ˆyiï¼‰ä¸‹ï¼ˆfenï¼‰ï¼Œæè¿°æ¯”è¾ƒå‚»ç“œåŒ–ï¼Œå®‰è£…è¿‡ç¨‹ä¸­åŸºæœ¬æ‰€æœ‰çš„é”™è¯¯å°±æåˆ°äº†ã€‚å¸Œæœ›èƒ½å¯¹åˆšè¸å…¥ Linux æœåŠ¡ç«¯çš„åŒå­¦æœ‰æ‰€å¸®åŠ©ã€‚\nå‚è€ƒæ–‡ç« ï¼š\nNginx æºç ç¼–è¯‘å®‰è£… CentOS 6.4ä¸‹ç¼–è¯‘å®‰è£…MySQL 5.6.14 ç¼–è¯‘å®‰è£…PHP7 beta1 PHP configuration error and Solutions in RPM ","date":"15 September 2015","permalink":"/new-centos-compiled-install-lnmp-environment/","section":"Posts","summary":"\u003cp\u003eå‰å‡ å¤©ä¹°äº†ä¸ª VPSï¼Œå› ä¸ºä¹‹å‰æ¥è§¦ Nginx ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥æŠ˜è…¾ LNMPç¯å¢ƒæŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ï¼Œæ‰€ä»¥æˆ‘æƒ³é‡æ–°å®‰è£…ä¸€éå¹¶å†™ç¯‡å­¦ä¹ ç¬”è®°ï¼Œæˆ–è€…è¯´æ•™ç¨‹ï¼Œå› æ­¤æœ¬æ–‡å°†ä»åœ¨å´­æ–°çš„ Centos ä¸Šæ­å»º LNMP ç¯å¢ƒï¼Œä¸ºäº†æ‰€æœ‰è½¯ä»¶éƒ½å¯ä»¥é€‰æ‹©æŒ‡å®šç‰ˆæœ¬å’Œå®‰è£…é…ç½®ï¼Œå› æ­¤é™¤äº†ä¾èµ–åŒ…ä¹‹å¤–éƒ½é‡‡ç”¨æºç åŒ…å®‰è£…çš„æ–¹å¼æ¥å®‰è£…ã€‚åºŸè¯ä¸å¤šè¯´ï¼ŒåˆšåˆšæŠŠ VPS rebulidã€‚\u003c/p\u003e","title":"Centosä¸Šä»é›¶å¼€å§‹ç¼–è¯‘å®‰è£…LNMPç¯å¢ƒ"},{"content":"","date":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories"}]